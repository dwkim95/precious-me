<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>마음의 나침반 | 내 마음 속 물건 찾기</title>
    <meta name="description" content="AI '아스트라'와 함께 떠나는 마음 탐험. 당신의 마음 속 방에는 어떤 물건이 놓여있을까요? 쉽고 따뜻한 심리 분석을 경험해보세요.">
    <meta property="og:title" content="마음의 나침반 - AI 심층 심리 분석">
    <meta property="og:description" content="AI가 발견한 내 마음 속 상징은 무엇일까요? 지금 바로 확인해보세요!">
    <meta property="og:image" content="https://i.ibb.co/3k5JqB4/og-image-compass.png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --font-main: 'Noto Sans KR', sans-serif;
            --bg-deep-blue: #121826;
            --bg-card: rgba(255, 255, 255, 0.05);
            --text-primary: #E0E6F1;
            --text-secondary: #94A3B8;
            --text-accent: #A5B4FC;
            --accent-point: #F472B6;
            --border-color: rgba(255, 255, 255, 0.1);
            --border-radius: 16px;
        }

        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: var(--font-main);
            font-weight: 400;
            background-color: var(--bg-deep-blue);
            color: var(--text-primary);
            line-height: 1.7;
            overflow-x: hidden;
        }

        #app { max-width: 500px; margin: 0 auto; padding: 30px 20px; position: relative; z-index: 1; min-height: 100vh; }
        
        .fade-in { animation: fadeIn 1s ease-out both; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .header { text-align: center; margin: 10vh 0; }
        .header h1 { font-size: 30px; font-weight: 700; }
        .header .subtitle { font-size: 16px; color: var(--text-secondary); margin-top: 12px; }
        .header .start-button {
            margin-top: 30px; padding: 14px 36px;
            font-size: 16px; font-weight: 500;
            background-color: var(--text-accent); color: var(--bg-deep-blue);
            border: none; border-radius: 30px; cursor: pointer;
            transition: all 0.2s ease;
        }
        .header .start-button:hover { transform: translateY(-2px); }

        .progress-container { margin-bottom: 24px; }
        #progress-text { text-align: center; font-size: 14px; color: var(--text-secondary); margin-bottom: 8px; }
        .progress-bar { width: 100%; height: 5px; background: rgba(255,255,255,0.1); border-radius: 2.5px; }
        #progress-fill { height: 100%; background: var(--text-accent); border-radius: 2.5px; transition: width 0.4s ease; }
        
        .question-container { text-align: center; margin: auto 0; }
        #question-box { font-size: 22px; font-weight: 500; word-break: keep-all; margin-bottom: 24px; }
        .choice-options { display: flex; flex-direction: column; gap: 12px; }
        .choice-option {
            background: var(--bg-card); border: 1px solid var(--border-color);
            border-radius: 12px; padding: 18px; cursor: pointer;
            transition: all 0.2s ease;
        }
        .choice-option:hover { background: rgba(255, 255, 255, 0.1); }
        .option-text { font-size: 16px; font-weight: 300; }
        
        .loading-screen { text-align: center; margin: auto; }
        .loading-text { font-size: 20px; font-weight: 500; }
        #star-shower { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; }
        .star { position: absolute; background: white; border-radius: 50%; animation: fall 2s linear forwards; }
        @keyframes fall { to { transform: translateY(100vh); opacity: 0; } }

        /* --- 결과 페이지 --- */
        .result-container { padding-top: 5vh; }
        .result-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: var(--border-radius); padding: 24px; margin-bottom: 20px; }
        .result-card h2 { font-size: 20px; font-weight: 700; color: var(--text-accent); margin-bottom: 12px; display: flex; align-items: center; }
        .result-card h2 .icon { margin-right: 10px; }
        .result-card p { font-size: 16px; line-height: 1.8; color: var(--text-secondary); font-weight: 300; }
        
        .artifact-header { text-align: center; padding: 16px 0; }
        .artifact-icon { font-size: 48px; margin-bottom: 16px; }
        .artifact-title { font-size: 24px; font-weight: 700; color: var(--text-primary); margin-bottom: 8px; }
        .artifact-subtitle { font-size: 16px; color: var(--accent-point); }
        
        .preference-container { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        .preference-box h3 { font-size: 16px; font-weight: 500; margin-bottom: 10px; }
        .preference-list { list-style: none; padding: 0; }
        .preference-list li { font-size: 15px; color: var(--text-secondary); margin-bottom: 6px; }
        
        .letter-card p:not(:last-child) { margin-bottom: 16px; }
        .share-buttons { margin-top: 24px; display: flex; gap: 12px; justify-content: center; }
        .share-btn {
            font-size: 15px; font-weight: 500;
            padding: 12px 24px; border-radius: 30px;
            border: 1px solid var(--border-color); background: rgba(255,255,255,0.1);
            color: var(--text-primary); cursor: pointer; transition: all 0.2s ease;
        }
        .share-btn:hover { background: var(--text-accent); color: var(--bg-deep-blue); border-color: var(--text-accent); }
    </style>
 </head>
 
 <body>
    <div id="star-shower"></div>
    <div id="app"></div>
 
    <script>
    //<![CDATA[(function() {
        const MindJourneyApp = {
            state: { currentQuestionIndex: 0, scores: {}, isNavigating: false },
            
            questions: [
                { question: "주말에 약속이 없다면, 주로 무엇을 하며 보내시나요?", options: [ { text: "평소 가고 싶었던 곳으로 훌쩍 떠나요.", weight: "suitcase" }, { text: "밀린 책을 읽거나 영화를 보며 생각을 정리해요.", weight: "lamp" }, { text: "친구들을 만나 맛있는 음식을 먹고 이야기 나눠요.", weight: "table" }, { text: "그림을 그리거나 악기를 연주하는 등 창작 활동을 해요.", weight: "sketchbook" } ]},
                { question: "당신에게 '성공'이란 무엇에 가장 가까운가요?", options: [ { text: "많은 경험을 통해 자유롭게 사는 것", weight: "suitcase" }, { text: "내가 하는 일에서 최고의 전문가가 되는 것", weight: "lamp" }, { text: "사랑하는 사람들과 행복하게 사는 것", weight: "sofa" }, { text: "세상에 긍정적인 영향을 주는 것", weight: "fireplace" } ]},
                { question: "힘들어하는 친구에게 어떤 위로를 건네고 싶으신가요?", options: [ { text: "문제의 원인을 분석하고 현실적인 해결책을 찾아줘요.", weight: "lamp" }, { text: "맛있는 음식을 사주며 기분을 전환시켜 줘요.", weight: "table" }, { text: "아무 말 없이 곁에서 이야기를 들어줘요.", weight: "sofa" }, { text: "함께 새로운 활동을 하며 슬픔을 잊게 도와줘요.", weight: "suitcase" } ]},
                { question: "새로운 아이디어가 떠올랐을 때, 당신의 첫 반응은?", options: [ { text: "'이게 정말 가능할까?' 실현 가능성부터 따져봐요.", weight: "fireplace" }, { text: "'재밌겠다!' 일단 구체적으로 어떻게 만들지 상상해봐요.", weight: "sketchbook" }, { text: "'다른 사람들은 어떻게 생각할까?' 주변에 물어봐요.", weight: "table" }, { text: "이 아이디어의 원리와 배경에 대해 더 깊이 탐구해요.", weight: "lamp" } ]},
                { question: "당신이 가장 편안함을 느끼는 공간은 어떤 곳인가요?", options: [ { text: "좋아하는 사람들과 함께하는 따뜻한 거실", weight: "fireplace" }, { text: "언제든 기댈 수 있는 푹신한 소파 위", weight: "sofa" }, { text: "나만의 생각에 집중할 수 있는 조용한 서재", weight: "lamp" }, { text: "새로운 영감이 떠오르는 나만의 작업 공간", weight: "sketchbook" } ]},
                { question: "다른 사람과 갈등이 생겼을 때, 어떻게 해결하는 편인가요?", options: [ { text: "상황을 주도하여 모두에게 이로운 방향으로 이끌어요.", weight: "fireplace" }, { text: "서로의 입장을 충분히 듣고 타협점을 찾으려 노력해요.", weight: "sofa" }, { text: "갈등 상황을 피하고, 새로운 화제로 분위기를 바꿔요.", weight: "table" }, { text: "잠시 거리를 두고 혼자 이성적으로 상황을 판단해요.", weight: "lamp" } ]},
                { question: "당신에게 '성장'이란 어떤 의미인가요?", options: [ { text: "다양한 경험을 통해 시야를 넓히는 것", weight: "suitcase" }, { text: "하나의 목표를 향해 꾸준히 나아가는 것", weight: "fireplace" }, { text: "어제보다 더 나은 아이디어를 떠올리는 것", weight: "sketchbook" }, { text: "주변 사람들과 더 깊은 관계를 맺는 것", weight: "table" } ]},
                { question: "당신이 가장 듣고 싶은 칭찬은 무엇인가요?", options: [ { text: "역시 믿음직스러워, 네 덕분에 든든해.", weight: "fireplace" }, { text: "너랑 있으면 편안하고 마음이 따뜻해져.", weight: "sofa" }, { text: "어떻게 그런 생각을 했어? 정말 독창적이다!", weight: "sketchbook" }, { text: "너의 이야기는 항상 흥미롭고 새로워.", weight: "suitcase" } ]}
            ],
            
            soulObjects: {
                lamp: { title: "고요한 서재의 램프", subtitle: "지혜와 통찰의 빛", icon: "💡", keywords: ["#지혜로운", "#통찰력있는", "#신중한"], likes: ["혼자만의 시간", "깊이 있는 대화", "지식 탐구"], dislikes: ["가볍고 피상적인 대화", "성급한 결정", "시끄러운 장소"], identity: "세상의 이치를 차분히 들여다보는 사람", struggle: "너무 많은 생각에 빠져 행동하기 어려웠던 순간들", social: "다른 사람의 길을 밝혀주는 등대" },
                fireplace: { title: "모두를 위한 벽난로", subtitle: "따뜻한 중심", icon: "🔥", keywords: ["#책임감있는", "#안정적인", "#리더"], likes: ["사람들을 챙겨주기", "계획 세우기", "신뢰받는 것"], dislikes: ["무질서하고 즉흥적인 상황", "무책임한 태도", "불확실함"], identity: "공동체의 중심을 지키는 든든한 사람", struggle: "모두를 책임져야 한다는 부담감과 무게", social: "모두가 기댈 수 있는 따뜻하고 견고한 벽" },
                sketchbook: { title: "새하얀 스케치북", subtitle: "무한한 가능성", icon: "🎨", keywords: ["#창의적인", "#상상력이 풍부한", "#독창적인"], likes: ["새로운 아이디어", "자유로운 표현", "나만의 방식으로 만들기"], dislikes: ["틀에 박힌 규칙", "반복적인 일상", "창의성을 억압하는 것"], identity: "세상에 없던 것을 상상하고 만드는 사람", struggle: "나의 독특한 세계를 남들이 이해해주지 못할까 봐 느끼는 불안함", social: "일상에 새로운 영감을 주는 예술가" },
                suitcase: { title: "오래된 여행 가방", subtitle: "자유와 경험의 기록", icon: "✈️", keywords: ["#자유로운", "#도전적인", "#경험을 중시하는"], likes: ["새로운 장소와 경험", "예측 불가능한 모험", "자유"], dislikes: ["정체되고 지루한 일상", "규칙과 제약", "깊은 소속감"], identity: "익숙한 곳을 떠나 새로운 세상을 탐험하는 사람", struggle: "한곳에 정착하지 못하고 마음 한편이 늘 공허했던 날들", social: "주변에 새로운 바람과 활기를 불어넣는 존재" },
                sofa: { title: "푹신한 소파", subtitle: "편안한 위로와 안식", icon: "🛋️", keywords: ["#편안한", "#다정한", "#수용적인"], likes: ["안정적인 관계", "편안한 분위기", "다른 사람의 이야기 들어주기"], dislikes: ["불편하고 어색한 관계", "날카로운 비판", "과도한 경쟁"], identity: "다른 사람의 이야기를 가만히 들어주고 감싸 안아주는 사람", struggle: "모든 사람에게 좋은 사람이 되려다 보니, 정작 내 마음을 돌보지 못했던 시간들", social: "누구나 지쳤을 때 아무 말 없이 기댈 수 있는 쉼터" },
                table: { title: "모두의 식탁", subtitle: "나눔과 연결의 즐거움", icon: "🍽️", keywords: ["#사교적인", "#즐거움을 추구하는", "#연결자"], likes: ["친구들과의 만남", "맛있는 음식 나누기", "유쾌한 대화"], dislikes: ["혼자 있는 것", "어색하고 조용한 분위기", "진지하고 무거운 이야기"], identity: "사람들을 연결하고 즐거운 순간을 만들어내는 사람", struggle: "가끔은 혼자가 되는 것을 견디기 힘들어했던 외로움", social: "모두를 하나로 모으는 즐거운 파티의 주최자" },
            },

            initDOM() {
                this.app = document.getElementById('app');
                this.renderWelcome();
            },
            renderWelcome() {
                this.app.innerHTML = `<div class="header fade-in"><h1>마음의 나침반</h1><p class="subtitle">AI 잠수함 '아스트라'와 함께<br>당신의 마음 속 방을 탐험해 보세요.</p><button class="header start-button">탐험 시작</button></div>`;
                this.app.querySelector('.start-button').addEventListener('click', () => {
                    this.startJourney();
                    this.animateSubmarine();
                });
            },
            animateSubmarine() {
                const submarine = document.createElement('div');
                submarine.innerHTML = `<svg viewBox="0 0 100 50" fill="currentColor" color="#90BFFF" width="80px"><path d="M10 25 a10 10 0 0 1 20 0 h40 a10 10 0 0 1 20 0 h10 v25 h-90 z M30 15 a5 5 0 1 1 10 0 a5 5 0 1 1 -10 0 M60 15 a5 5 0 1 1 10 0 a5 5 0 1 1 -10 0"/></svg>`;
                submarine.style.cssText = `position:fixed; top:40%; left:50%; transform:translateX(-50%); z-index:20; transition: all 1.5s ease-in-out;`;
                document.body.appendChild(submarine);
                setTimeout(() => {
                    submarine.style.transform = 'translateX(-50%) translateY(100vh) scale(0.5)';
                    submarine.style.opacity = '0';
                }, 100);
                setTimeout(() => { submarine.remove(); }, 1600);
            },
            startJourney() { this.resetState(); this.renderQuestion(); },
            resetState() { this.state.currentQuestionIndex = 0; this.state.scores = {}; this.state.isNavigating = false; },
            renderQuestion() {
                const index = this.state.currentQuestionIndex;
                const q = this.questions[index];
                const progress = ((index + 1) / this.questions.length) * 100;
                this.app.innerHTML = `<div class="journey-container fade-in"><div class="progress-container"><div id="progress-text">질문 ${index + 1} / ${this.questions.length}</div><div class="progress-bar"><div id="progress-fill" style="width:${progress}%"></div></div></div><div class="question-card"><h3 id="question-box">${q.question}</h3><div class="choice-options">${q.options.map(opt => `<div class="choice-option" data-weight="${opt.weight}"><span class="option-text">${opt.text}</span></div>`).join('')}</div></div></div>`;
                this.app.querySelectorAll('.choice-option').forEach(el => { el.addEventListener('click', () => this.handleSelection(el.dataset.weight)); });
            },
            handleSelection(weight) {
                if (this.state.isNavigating) return;
                this.state.isNavigating = true;
                this.state.scores[weight] = (this.state.scores[weight] || 0) + 1;
                this.app.querySelector('.journey-container').style.opacity = 0;
                setTimeout(() => {
                    if (this.state.currentQuestionIndex < this.questions.length - 1) {
                        this.state.currentQuestionIndex++;
                        this.renderQuestion();
                        this.state.isNavigating = false;
                    } else { this.renderLoading(); }
                }, 400);
            },
            renderLoading() {
                this.app.innerHTML = `<div class="loading-screen fade-in"><div class="loading-graphic">✨</div><h2 class="loading-text">마음 속을 여행하며<br>당신을 닮은 물건을 찾고 있어요...</h2></div>`;
                this.createStars();
                setTimeout(() => {
                    this.renderResults();
                    document.getElementById('star-shower').innerHTML = '';
                }, 3000);
            },
            createStars() {
                const container = document.getElementById('star-shower');
                if (!container) return;
                for (let i = 0; i < 15; i++) {
                    const star = document.createElement('div');
                    star.className = 'star';
                    star.style.width = `${Math.random() * 2 + 1}px`;
                    star.style.height = star.style.width;
                    star.style.left = `${Math.random() * 100}vw`;
                    star.style.animationDelay = `${Math.random() * 2}s`;
                    star.style.animationDuration = `${Math.random() * 2 + 1}s`;
                    container.appendChild(star);
                }
            },
            renderResults() {
                const analysis = this.analyze();
                const artifact = this.soulObjects[analysis.primary] || this.soulObjects.lamp;
                this.app.innerHTML = `
                    <div class="result-container fade-in">
                        <div class="result-card">
                            <div class="artifact-header">
                                <p style="font-size:16px; color: var(--text-secondary);">당신의 마음의 방에는...</p>
                                <div class="artifact-icon">${artifact.icon}</div>
                                <h2 class="artifact-title" style="color:var(--text-primary); margin:0;">${artifact.title}</h2>
                                <p class="artifact-subtitle">${artifact.subtitle}</p>
                                <p class="flavor-keywords">${artifact.keywords.map(k => `#${k}`).join(' ')}</p>
                            </div>
                            <p>${artifact.description}</p>
                        </div>
                        <div class="result-card">
                            <h2><span class="icon">👍</span>당신이 좋아하는 것 & <span class="icon">👎</span>힘들어하는 것</h2>
                            <div class="preference-container">
                                <div class="preference-box">
                                    <h3>이런 걸 좋아해요</h3>
                                    <ul class="preference-list">${artifact.likes.map(like => `<li>${like}</li>`).join('')}</ul>
                                </div>
                                <div class="preference-box">
                                    <h3>이런 건 조금 힘들어요</h3>
                                    <ul class="preference-list">${artifact.dislikes.map(dislike => `<li>${dislike}</li>`).join('')}</ul>
                                </div>
                            </div>
                        </div>
                        <div class="result-card letter-card">
                            <h2><span class="icon">💌</span>당신의 마음에게</h2>
                            ${this.getComfortMessage(analysis)}
                        </div>
                        <div class="share-buttons">
                            <button class="share-btn" id="share-kakao">카카오톡으로 공유</button>
                            <button class="share-btn" id="copy-link">링크 복사</button>
                        </div>
                        <button class="restart-button" onclick="MindJourneyApp.initDOM()">다시 탐험하기</button>
                    </div>`;
                this.addShareEventListeners(artifact.title);
            },
            
            analyze() {
                const sorted = Object.entries(this.state.scores).sort((a,b) => b[1] - a[1]);
                return {
                    primary: sorted.length > 0 ? sorted[0][0] : "lamp",
                    secondary: sorted.length > 1 ? sorted[1][0] : null,
                };
            },
            getComfortMessage(analysis) {
                const p = this.soulObjects[analysis.primary] || this.soulObjects.lamp;
                const s = analysis.secondary ? this.soulObjects[analysis.secondary] : null;

                let struggle = `말은 안 해도, 어쩌면 당신은 그동안 혼자 끙끙 앓아왔을지 모릅니다. 바로 '${p.struggle}' 때문에 말이죠.`;
                if (s) {
                    struggle += ` 때로는 '${s.struggle}'까지 더해져, 그 무게가 더욱 버거웠을 겁니다.`;
                } else {
                    struggle += ` 그 마음을 누구에게도 쉽게 털어놓지 못했을 겁니다.`;
                }
                
                return `<p>당신은 **${p.identity}**입니다.</p><p>${struggle}</p><p>하지만 기억하세요. 그런 당신이기에, 주변 사람들에게 당신은 **${p.social}**입니다. 당신의 존재는 이미 누군가에게 큰 힘이 되고 있습니다.</p>`;
            },
            addShareEventListeners(resultTitle) {
                const shareText = `AI가 발견한 내 마음 속 물건은... [${resultTitle}]이래요! 😲 너의 마음 속에는 어떤 물건이 있을까?`;
                const shareUrl = window.location.href;

                // Web Share API (모바일 우선)
                if (navigator.share) {
                    document.getElementById('share-kakao').addEventListener('click', () => {
                        navigator.share({
                            title: '마음의 나침반',
                            text: shareText,
                            url: shareUrl,
                        }).catch(console.error);
                    });
                } else {
                    document.getElementById('share-kakao').style.display = 'none'; // 지원 안 하면 카톡 버튼 숨김
                }
                
                // 링크 복사 (폴백)
                document.getElementById('copy-link').addEventListener('click', () => {
                    navigator.clipboard.writeText(shareUrl).then(() => {
                        alert('링크가 복사되었어요! 친구에게 공유해보세요.');
                    }).catch(err => {
                        console.error('Could not copy text: ', err);
                        alert('링크 복사에 실패했어요.');
                    });
                });
            }
        };
 
         document.addEventListener('DOMContentLoaded', () => { MindJourneyApp.initDOM(); });
     })()]];
     </script>
 </body>
 </html>
