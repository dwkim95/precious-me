<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>ë§ˆìŒì˜ ë‚˜ì¹¨ë°˜ | AIê°€ ê·¸ë ¤ì£¼ëŠ” ë‹¹ì‹ ì˜ ë§ˆìŒ ì§€ë„</title>
    
    <meta name="description" content="AI ê¸°ë°˜ ì‹¬ì¸µ ì‹¬ë¦¬ ë¶„ì„ìœ¼ë¡œ ë‹¹ì‹ ë§Œì˜ ë§ˆìŒ ì§€ë„ë¥¼ ê·¸ë ¤ë³´ì„¸ìš”. ë‹¹ì‹ ì˜ ë‚´ë©´ ê¹Šì€ ê³³ì— ìˆ¨ê²¨ì§„ ì´ì•¼ê¸°ë¥¼ ë°œê²¬í•˜ëŠ” ì—¬ì •.">
    <meta name="keywords" content="ì‹¬ë¦¬í…ŒìŠ¤íŠ¸, AI ì‹¬ë¦¬ë¶„ì„, ë§ˆìŒì¹˜ìœ , ì„±ê²©ìœ í˜•, ë‚´ë©´íƒêµ¬, ë§ˆìŒì˜ ë‚˜ì¹¨ë°˜, ìœ„ë¡œ">
    
    <meta property="og:title" content="ë§ˆìŒì˜ ë‚˜ì¹¨ë°˜ - AI ì‹¬ì¸µ ì‹¬ë¦¬ ë¶„ì„">
    <meta property="og:description" content="AIê°€ ë‹¹ì‹ ì˜ ë‹µë³€ì„ í†µí•´ ì„¬ì„¸í•œ ë§ˆìŒ ì§€ë„ë¥¼ ê·¸ë ¤ë“œë¦½ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì˜í˜¼ì€ ì–´ë–¤ í’ê²½ì„ ë‹´ê³  ìˆì„ê¹Œìš”?">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://images.unsplash.com/photo-1506880018603-c0e3582f0668?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3wzOTAwNXwwfDF8c2VhcmNofDEzfHxjb21wYXNzJTIwbmVidWxhaGVhcnR8ZW58MHx8fHwxNzE4OTk0NjU0fDA&ixlib=rb-4.0.3&q=80&w=1200">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Noto+Serif+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-primary: #0D1117;
            --bg-gradient: linear-gradient(180deg, #161b22 0%, #0d1117 100%);
            --surface-glass: rgba(255, 255, 255, 0.05);
            --surface-glass-hover: rgba(255, 255, 255, 0.1);
            --border-glass: 1px solid rgba(255, 255, 255, 0.1);
            --text-primary: #e6edf3;
            --text-secondary: #7d8590;
            --text-accent: #58a6ff;
            --accent-glow: #388bfd;
            --accent-warm: #f778ba;
            --shadow-soft: 0 8px 32px rgba(0, 0, 0, 0.3);
            --shadow-glow: 0 0 24px rgba(56, 139, 253, 0.3);
            --border-radius: 16px;
            --transition-smooth: all 0.5s cubic-bezier(0.25, 1, 0.5, 1);
        }

        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--bg-primary);
            background-image: var(--bg-gradient);
            color: var(--text-primary);
            min-height: 100vh;
            min-height: -webkit-fill-available;
            line-height: 1.8;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        #particles-js {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }

        #app {
            max-width: 520px;
            margin: 0 auto;
            padding: 24px;
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            min-height: -webkit-fill-available;
        }

        .glass-card {
            background: var(--surface-glass);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: var(--border-radius);
            border: var(--border-glass);
            box-shadow: var(--shadow-soft);
            transition: var(--transition-smooth);
            animation: fadeIn 1s ease-out both;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .header {
            text-align: center;
            padding: 32px;
            margin-bottom: 24px;
        }

        .header h1 {
            font-family: 'Noto Serif KR', serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--text-accent);
            text-shadow: 0 0 12px var(--accent-glow);
            margin-bottom: 8px;
        }

        .header .subtitle {
            font-size: 16px;
            color: var(--text-secondary);
            font-weight: 400;
        }
        
        .content {
            padding: 24px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        /* --- Progress Bar --- */
        .progress-container { margin-bottom: 32px; }
        .progress-bar { width: 100%; height: 6px; background: rgba(255, 255, 255, 0.1); border-radius: 3px; overflow: hidden; }
        #progress-fill { height: 100%; background: var(--text-accent); box-shadow: 0 0 10px var(--accent-glow); border-radius: 3px; transition: width 0.6s ease-in-out; }
        #progress-text { text-align: right; margin-top: 8px; font-size: 12px; color: var(--text-secondary); }

        /* --- Question Area --- */
        .question-container { text-align: center; margin-bottom: 24px; }
        #question-number { font-size: 14px; color: var(--text-accent); margin-bottom: 12px; font-weight: 600; }
        #question-box { font-family: 'Noto Serif KR', serif; font-size: 22px; font-weight: 600; margin-bottom: 8px; line-height: 1.5; }
        #question-description { font-size: 15px; color: var(--text-secondary); font-style: italic; }

        /* --- Answer Options --- */
        .choice-options { display: flex; flex-direction: column; gap: 12px; margin-bottom: 32px; }
        .choice-option { background: var(--surface-card, rgba(0,0,0,0.2)); border: var(--border-glass); border-radius: 12px; padding: 18px; cursor: pointer; transition: all 0.3s ease; text-align: left; }
        .choice-option:hover { background: var(--surface-glass-hover); transform: translateY(-3px); }
        .choice-option.selected { background: var(--text-accent); color: var(--bg-primary); border-color: var(--accent-glow); box-shadow: var(--shadow-glow); }
        .choice-option.selected .option-text { color: var(--bg-primary); font-weight: 600; }
        .option-text { font-size: 16px; font-weight: 500; word-break: keep-all; }
        
        textarea { width: 100%; min-height: 120px; padding: 16px; font-size: 16px; font-family: 'Noto Serif KR', serif; border: var(--border-glass); border-radius: 12px; background: var(--surface-card, rgba(0,0,0,0.2)); color: var(--text-primary); resize: vertical; transition: var(--transition-smooth); }
        textarea:focus { outline: none; background: var(--surface-glass-hover); border-color: var(--text-accent); box-shadow: var(--shadow-glow); }

        /* --- Navigation --- */
        .navigation { display: flex; justify-content: space-between; align-items: center; margin-top: auto; padding-top: 24px; }
        .btn { background: var(--text-accent); color: var(--bg-primary); border: none; padding: 14px 28px; font-size: 16px; font-weight: 600; border-radius: 30px; cursor: pointer; transition: var(--transition-smooth); box-shadow: var(--shadow-soft); }
        .btn:hover { transform: translateY(-3px); box-shadow: var(--shadow-glow); }
        .btn-secondary { background: transparent; color: var(--text-secondary); border: 1px solid var(--text-secondary); }
        .btn-secondary:hover { color: var(--text-primary); border-color: var(--text-primary); }

        /* --- Loading Screen --- */
        .loading-screen { text-align: center; padding: 60px 24px; }
        .compass-loader { width: 120px; height: 120px; margin: 0 auto 32px; position: relative; animation: fadeIn 1s ease; }
        .compass-bg { width: 100%; height: 100%; border: 2px solid rgba(255, 255, 255, 0.1); border-radius: 50%; }
        .compass-needle { width: 4px; height: 50%; background: var(--accent-warm); position: absolute; top: 0; left: 50%; transform-origin: bottom center; transform: translateX(-50%) rotate(0deg); animation: compass-spin 2s infinite cubic-bezier(0.6, 0, 0.4, 1); }
        .compass-center { width: 12px; height: 12px; background: var(--accent-warm); border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        @keyframes compass-spin { from { transform: translateX(-50%) rotate(0deg); } to { transform: translateX(-50%) rotate(360deg); } }
        .loading-text { font-family: 'Noto Serif KR', serif; font-size: 18px; font-weight: 600; margin-bottom: 12px; color: var(--text-accent); }
        .loading-subtext { font-size: 14px; color: var(--text-secondary); }

        /* --- Result Page --- */
        .result-container { animation: resultFadeIn 1s ease-out; }
        .result-header { text-align: center; margin-bottom: 32px; padding: 32px 24px; }
        .result-title { font-family: 'Noto Serif KR', serif; font-size: 26px; font-weight: 700; margin-bottom: 12px; color: var(--text-primary); }
        .result-metaphor { font-size: 17px; font-style: italic; color: var(--text-secondary); font-weight: 400; }
        .result-summary { margin-top: 24px; }
        .trait-bar { display: flex; align-items: center; margin-bottom: 8px; }
        .trait-name { width: 140px; font-size: 14px; color: var(--text-secondary); }
        .trait-progress-bg { flex-grow: 1; height: 8px; background: var(--surface-glass); border-radius: 4px; }
        .trait-progress-fill { height: 100%; background: linear-gradient(90deg, var(--text-accent), var(--accent-warm)); border-radius: 4px; transition: width 1.5s ease-out; }
        
        .accordion-item { background: var(--surface-glass); border-radius: var(--border-radius); margin-bottom: 12px; overflow: hidden; border: var(--border-glass); }
        .accordion-header { padding: 18px 24px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .accordion-header h3 { font-family: 'Noto Serif KR', serif; font-size: 18px; font-weight: 600; color: var(--text-accent); }
        .accordion-arrow { transition: transform 0.4s ease; font-size: 20px; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-out, padding 0.5s ease-out; }
        .accordion-content-inner { padding: 0 24px 24px; font-size: 15px; color: var(--text-secondary); line-height: 1.8; text-align: justify; word-break: keep-all; }
        .accordion-item.active .accordion-arrow { transform: rotate(180deg); }
        .keywords-container { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 16px; }
        .keyword { background: rgba(255, 255, 255, 0.1); color: var(--text-secondary); padding: 6px 14px; border-radius: 20px; font-size: 13px; font-weight: 500; }

        .share-section { text-align: center; margin-top: 32px; }
        .share-buttons { display: flex; flex-direction: column; gap: 12px; align-items: center; margin-top: 16px; }
        .share-buttons .btn { width: 100%; max-width: 280px; }
        .kakao-btn { background: #FEE500; color: #191919; }

        @media (max-width: 480px) {
            #app { padding: 16px; }
            .content, .header { padding: 24px 16px; }
            #question-box { font-size: 20px; }
        }
    </style>
</head>

<body>
    <div id="particles-js"></div>
    <div id="app">
        <header class="header glass-card">
            <h1>ğŸ§­ ë§ˆìŒì˜ ë‚˜ì¹¨ë°˜</h1>
            <p class="subtitle">AIê°€ ê·¸ë ¤ì£¼ëŠ” ë‹¹ì‹ ì˜ ë§ˆìŒ ì§€ë„</p>
        </header>

        <main class="content glass-card" id="main-content">
            </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script>
    //<![CDATA[
    const MindCompassApp = {
        // --- 1. CONFIGURATION & DATA ---
        questions: [
            // (ê¸°ì¡´ ì§ˆë¬¸ ë°ì´í„°ì™€ ë™ì¼)
            { id: 1, type: "choice", question: "ë°¤í•˜ëŠ˜ì˜ ë³„ì„ ë°”ë¼ë³¼ ë•Œ, ë‹¹ì‹ ì˜ ë§ˆìŒì— ê°€ì¥ ë¨¼ì € ìŠ¤ë©°ë“œëŠ” ê°ì •ì€?", description: "ë³„ë¹›ì´ ë‹¹ì‹ ì˜ ì˜í˜¼ì— ë‹¿ëŠ” ê·¸ ìˆœê°„ì„ ë– ì˜¬ë ¤ë³´ì„¸ìš”", options: [{ text: "ë¬´í•œí•œ ìš°ì£¼ ì•ì—ì„œ ëŠë¼ëŠ” ê²½ì´ë¡œì›€ê³¼ ì „ìœ¨", keywords: ["ì˜í˜¼ì˜íƒí—˜ê°€", "ìš°ì£¼ì ê°ìˆ˜ì„±", "ê²½ì´ë¡œìš´ì‹œì„ "], weight: "cosmic_wonder" }, { text: "ìì‹ ì˜ ì¡´ì¬ê°€ í•œì—†ì´ ì‘ê²Œ ëŠê»´ì§€ëŠ” ê²¸ì†í•¨", keywords: ["ì‹¬ì—°ì˜ì§€í˜œ", "ê²¸ì†í•œì˜í˜¼", "ì¡´ì¬ì ì„±ì°°"], weight: "humble_depth" }, { text: "ì–´ë””ë¡ ê°€ ë– ë‚˜ê³  ì‹¶ì€ ììœ ë¡œìš´ ì¶©ë™", keywords: ["ë°”ëŒì˜ì•„ì´", "ë¬´í•œììœ ", "ë– ë‚¨ì˜ë¯¸í•™"], weight: "wandering_soul" }, { text: "ê³ ìš”í•¨ ì†ì—ì„œ ì°¾ëŠ” ë§ˆìŒì˜ í‰í™”ë¡œì›€", keywords: ["ë‹¬ë¹›ëª…ìƒ", "ê³ ìš”í•œì¹˜ìœ ", "ë‚´ë©´ì˜ì •ì›"], weight: "serene_peace" }]},
            { id: 2, type: "choice", question: "ì–´ë¦° ì‹œì ˆ, ë‹¹ì‹ ì´ ê°€ì¥ ì•ˆì „í•˜ë‹¤ê³  ëŠê¼ˆë˜ ìˆœê°„ì˜ í–¥ê¸°ë‚˜ ì†Œë¦¬ëŠ”?", description: "ê·¸ ê¸°ì–µ ì† ê°ê°ì´ ì§€ê¸ˆë„ ë‹¹ì‹ ì„ ì–´ë–»ê²Œ ìœ„ë¡œí•˜ëŠ”ì§€ ëŠê»´ë³´ì„¸ìš”", options: [{ text: "ì—„ë§ˆì˜ í’ˆì—ì„œ ë§¡ì•˜ë˜ ë”°ëœ»í•œ í–¥ê³¼ ì‹¬ì¥ì†Œë¦¬", keywords: ["ëª¨ì„±ì˜í’ˆ", "ì›ì´ˆì ì•ˆì „", "ì‹¬ì¥ì˜ë¦¬ë“¬"], weight: "maternal_warmth" }, { text: "ë¹„ ì˜¤ëŠ” ë‚  ì°½ê°€ì—ì„œ ë“¤ì—ˆë˜ ë¹—ì†Œë¦¬ì™€ ì±… ëƒ„ìƒˆ", keywords: ["ë¹—ì†Œë¦¬ì¹˜ìœ ", "ì±…ì˜ë§ˆë²•", "ì°½ê°€ì˜ê¿ˆ"], weight: "contemplative_solitude" }, { text: "í• ë¨¸ë‹ˆ ì†ì—ì„œ í’ê¸°ë˜ ê½ƒí–¥ê¸°ì™€ ìì¥ê°€", keywords: ["ì„¸ëŒ€ì˜ì§€í˜œ", "ê½ƒí–¥ê¸°ê¸°ì–µ", "ìì¥ê°€ì˜ë§ˆë²•"], weight: "ancestral_comfort" }, { text: "í˜¼ìë§Œì˜ ë¹„ë°€ê³µê°„ì—ì„œ ëŠê¼ˆë˜ ê³ ìš”í•¨", keywords: ["ë¹„ë°€ì˜ì„±", "í˜¼ìë§Œì˜ì„¸ê³„", "ê³ ë…ì˜ë‹¬ì½¤í•¨"], weight: "secret_sanctuary" }]},
            { id: 3, type: "choice", question: "ë‹¹ì‹ ì´ ê°€ì¥ ê¹Šì´ ëª°ì…í•  ìˆ˜ ìˆëŠ” ìˆœê°„ì€ ì–¸ì œì¸ê°€ìš”?", description: "ì‹œê°„ì´ ë©ˆì¶˜ ë“¯ ëŠê»´ì§€ëŠ” ê·¸ ë§ˆë²•ê°™ì€ ìˆœê°„ë“¤", options: [{ text: "ì°½ì‘ì´ë‚˜ ì˜ˆìˆ  ì‘ì—…ì— ì™„ì „íˆ ë¹ ì ¸ë“¤ ë•Œ", keywords: ["ì°½ì¡°ì˜ë¶ˆê½ƒ", "ì˜ˆìˆ í˜¼", "ì˜ê°ì˜ìˆœê°„"], weight: "creative_flow" }, { text: "ì‚¬ë‘í•˜ëŠ” ì‚¬ëŒê³¼ ì§„ì†”í•œ ëŒ€í™”ë¥¼ ë‚˜ëˆŒ ë•Œ", keywords: ["ì˜í˜¼ì˜ëŒ€í™”", "ì§„ì‹¬ì˜êµë¥˜", "ë§ˆìŒì˜ê³µëª…"], weight: "deep_connection" }, { text: "ìì—° ì†ì—ì„œ ê³ ìš”íˆ ì‚¬ìƒ‰ì— ì ê¸¸ ë•Œ", keywords: ["ìì—°ì˜ì†ì‚­ì„", "ì‚¬ìƒ‰ì˜ê¹Šì´", "ì˜ì êµê°"], weight: "nature_meditation" }, { text: "ìƒˆë¡œìš´ ì§€ì‹ì„ íƒêµ¬í•˜ê³  ê¹¨ë‹¬ìŒì„ ì–»ì„ ë•Œ", keywords: ["ì§€ì‹ì˜íƒí—˜", "ê¹¨ë‹¬ìŒì˜ìˆœê°„", "í•™ë¬¸ì ì—´ì •"], weight: "intellectual_discovery" }]},
            { id: 4, type: "text", question: "ì§€ê¸ˆê¹Œì§€ ë‹¹ì‹ ì„ ê°€ì¥ í¬ê²Œ ë³€í™”ì‹œí‚¨ í•œ ìˆœê°„ì´ ìˆë‹¤ë©´, ê·¸ë•Œì˜ ê°ì •ì„ í•œ ë¬¸ì¥ìœ¼ë¡œ í‘œí˜„í•´ì£¼ì„¸ìš”.", description: "ê·¸ ìˆœê°„ì´ ì§€ê¸ˆì˜ ë‹¹ì‹ ì—ê²Œ ì–´ë–¤ ì˜ë¯¸ì¸ì§€ ì§„ì†”í•˜ê²Œ ì ì–´ë³´ì„¸ìš”", keywords: ["ë³€í™”ì˜ìˆœê°„", "ì„±ì¥ì˜ê¸°ì–µ", "ì¸ìƒì „í™˜ì "], analysis_focus: "transformation_moment" },
            { id: 5, type: "choice", question: "ê¿ˆì†ì—ì„œ ìì£¼ ë‚˜íƒ€ë‚˜ëŠ” ê³µê°„ì´ë‚˜ ìƒí™©ì€?", description: "ë¬´ì˜ì‹ ê¹Šì€ ê³³ì—ì„œ ì˜¬ë¼ì˜¤ëŠ” ì´ë¯¸ì§€ë“¤ì˜ ì˜ë¯¸ë¥¼ íƒêµ¬í•´ë³´ì„¸ìš”", options: [{ text: "ëì—†ì´ í¼ì³ì§„ ë°”ë‹¤ë‚˜ ë¬´í•œí•œ í•˜ëŠ˜", keywords: ["ë¬´í•œì˜ê¿ˆ", "ììœ ì˜ë°”ë‹¤", "í•˜ëŠ˜ì˜ì•„ì´"], weight: "infinite_expansion" }, { text: "ë³µì¡í•œ ë¯¸ë¡œë‚˜ ì•Œ ìˆ˜ ì—†ëŠ” ê±´ë¬¼ë“¤", keywords: ["ë¯¸ë¡œì˜ì‹¬ë¦¬", "ë³µì¡ì„±íƒêµ¬", "ìˆ¨ê²¨ì§„ë¬¸"], weight: "complex_psyche" }, { text: "ë”°ëœ»í•˜ê³  í¬ê·¼í•œ ì§‘ì´ë‚˜ ì•ˆì „í•œ ê³µê°„", keywords: ["ì•ˆì „ì˜ê¿ˆ", "í¬ê·¼í•œê·€í™˜", "ì§‘ì˜ì˜ë¯¸"], weight: "safe_haven" }, { text: "ê¿ˆì„ ì˜ ê¸°ì–µí•˜ì§€ ëª»í•˜ê±°ë‚˜ í˜„ì‹¤ì ì¸ ê¿ˆ", keywords: ["í˜„ì‹¤ì˜ë¬´ê²Œ", "ì‹¤ìš©ì ì˜í˜¼", "ë•…ì˜ì•„ì´"], weight: "grounded_realism" }]},
            { id: 6, type: "choice", question: "ê¹Šì€ ìƒì²˜ë¥¼ ë°›ì•˜ì„ ë•Œ, ë‹¹ì‹ ì˜ ë§ˆìŒì€ ì–´ë–¤ ìƒ‰ê¹”ê³¼ ì§ˆê°ì„ ê°–ë‚˜ìš”?", description: "ê³ í†µì˜ ìˆœê°„ì— ëŠë¼ëŠ” ë‹¹ì‹ ë§Œì˜ ê°ì •ì˜ ìƒ‰ì±„ì™€ ì´‰ê°", options: [{ text: "ì§™ì€ ë°”ë‹¤ìƒ‰ - ê¹Šê³  ì°¨ê°€ìš´ ìŠ¬í””ì˜ ë¬´ê²Œ", keywords: ["ê¹Šì€ë°”ë‹¤", "ìŠ¬í””ì˜ë¬´ê²Œ", "ì¹¨ë¬µì˜ê¹Šì´"], weight: "deep_melancholy" }, { text: "íšŒìƒ‰ ì•ˆê°œ - ëª¨ë“  ê²ƒì´ íë¦¿í•˜ê³  ë¬´ê¸°ë ¥í•¨", keywords: ["ì•ˆê°œì˜ë§ˆìŒ", "ë¬´ê¸°ë ¥ì˜íšŒìƒ‰", "íë¦°ì˜ì‹"], weight: "foggy_numbness" }, { text: "ë¶‰ì€ ë¶ˆê½ƒ - ë¶„ë…¸ì™€ ê²©ì •ì´ íƒ€ì˜¤ë¦„", keywords: ["ë¶„ë…¸ì˜ë¶ˆê½ƒ", "ê²©ì •ì˜ë¶‰ìŒ", "ì—´ì •ì˜ì—­ì„¤"], weight: "fiery_passion" }, { text: "ê²€ì€ êµ¬ë© - ë¹›ì´ ë‹¿ì§€ ì•ŠëŠ” ì™„ì „í•œ ì–´ë‘ ", keywords: ["ì–´ë‘ ì˜ê¹Šì´", "ì ˆë§ì˜ê²€ì •", "ì¹¨ë¬µì˜êµ¬ë©"], weight: "void_darkness" }]},
            { id: 7, type: "choice", question: "í˜¼ìë§Œì˜ ì‹œê°„ì— ê°€ì¥ ìì£¼ ë– ì˜¬ë¦¬ëŠ” ìƒê°ì˜ ë°©í–¥ì€?", description: "ê³ ìš”í•œ ìˆœê°„ì— ë§ˆìŒ ê¹Šì€ ê³³ì—ì„œ ì˜¬ë¼ì˜¤ëŠ” ìƒê°ë“¤ì˜ íë¦„", options: [{ text: "ì§€ë‚˜ê°„ ì‹œê°„ë“¤ê³¼ ê·¸ë•Œì˜ ê°ì •ë“¤ì„ ë˜ìƒˆê¹€", keywords: ["ì‹œê°„ì˜ê°•", "ì¶”ì–µì˜ë³´ì„", "ê³¼ê±°ì˜í–¥ìˆ˜"], weight: "nostalgic_reflection" }, { text: "ì•ìœ¼ë¡œì˜ ê°€ëŠ¥ì„±ê³¼ ê¿ˆë“¤ì„ ê·¸ë ¤ë´„", keywords: ["ë¯¸ë˜ì˜ì”¨ì•—", "ê¿ˆì˜ì„¤ê³„ë„", "í¬ë§ì˜ì§€í‰"], weight: "future_dreaming" }, { text: "í˜„ì¬ì˜ ë¬¸ì œë“¤ê³¼ í•´ê²°ë°©ë²•ì„ ëª¨ìƒ‰í•¨", keywords: ["í˜„ì‹¤ì˜í•´ë‹µ", "ë¬¸ì œì˜ì‹¤íƒ€ë˜", "ì‹¤ìš©ì ì§€í˜œ"], weight: "practical_solving" }, { text: "ì¡´ì¬ì˜ ì˜ë¯¸ì™€ ì‚¶ì˜ ë³¸ì§ˆì„ íƒêµ¬í•¨", keywords: ["ì¡´ì¬ì˜ì§ˆë¬¸", "ì² í•™ì˜ê¸¸", "ì˜ë¯¸ì˜íƒêµ¬"], weight: "existential_inquiry" }]},
            { id: 8, type: "text", question: "ë‹¹ì‹ ì—ê²Œ 'ìš©ì„œ'ë€ ë¬´ì—‡ì¸ê°€ìš”? í•œ ë¬¸ì¥ìœ¼ë¡œ ì •ì˜í•´ì£¼ì„¸ìš”.", description: "ìš©ì„œì— ëŒ€í•œ ë‹¹ì‹ ë§Œì˜ ì² í•™ì„ ì§„ì†”í•˜ê²Œ í‘œí˜„í•´ë³´ì„¸ìš”", keywords: ["ìš©ì„œì˜ì² í•™", "ì¹˜ìœ ì˜ì§€í˜œ", "ë§ˆìŒì˜ììœ "], analysis_focus: "forgiveness_philosophy" },
            { id: 9, type: "choice", question: "ë‹¹ì‹ ì´ ê°€ì¥ ê¹Šì´ ë‘ë ¤ì›Œí•˜ëŠ” ê²ƒì€ ë¬´ì—‡ì¸ê°€ìš”?", description: "ë§ˆìŒ ê¹Šì€ ê³³ì— ìˆ¨ì–´ìˆëŠ” ê·¼ë³¸ì ì¸ ë‘ë ¤ì›€ì„ ë§ˆì£¼í•´ë³´ì„¸ìš”", options: [{ text: "ì‚¬ë‘í•˜ëŠ” ì‚¬ëŒë“¤ê³¼ì˜ ì˜ì›í•œ ì´ë³„", keywords: ["ì´ë³„ì˜ê³µí¬", "ì‚¬ë‘ì˜ìƒì‹¤", "ì˜ì›í•œì‘ë³„"], weight: "separation_fear" }, { text: "ìì‹ ì˜ ì§„ì •í•œ ê°€ëŠ¥ì„±ì„ ë°œê²¬í•˜ì§€ ëª»í•˜ëŠ” ê²ƒ", keywords: ["ì ì¬ë ¥ì˜ë¬˜ì§€", "ë¯¸ì™„ì„±ì˜ì¸ìƒ", "ê°€ëŠ¥ì„±ì˜ìƒì‹¤"], weight: "unfulfilled_potential" }, { text: "ì™„ì „íˆ í˜¼ìê°€ ë˜ì–´ ë²„ë ¤ì§€ëŠ” ê²ƒ", keywords: ["ê³ ë…ì˜ì‹¬ì—°", "ë²„ë¦¼ë°›ìŒ", "ì¡´ì¬ì˜ì†Œê±°"], weight: "ultimate_abandonment" }, { text: "ëª¨ë“  í†µì œë ¥ì„ ìƒê³  ë¬´ë ¥í•´ì§€ëŠ” ê²ƒ", keywords: ["í†µì œì˜ìƒì‹¤", "ë¬´ë ¥ê°ì˜ëŠª", "ì¹´ì˜¤ìŠ¤ì˜ê³µí¬"], weight: "loss_of_control" }]},
            { id: 10, type: "choice", question: "ë§ˆì§€ë§‰ìœ¼ë¡œ, ì§€ê¸ˆ ì´ ìˆœê°„ ë‹¹ì‹ ì˜ ë§ˆìŒì´ ê°€ì¥ ê°„ì ˆíˆ ì›í•˜ëŠ” ê²ƒì€?", description: "ì†”ì§í•œ ë§ˆìŒìœ¼ë¡œ í˜„ì¬ ê°€ì¥ í•„ìš”ë¡œ í•˜ëŠ” ê²ƒì„ ì„ íƒí•´ì£¼ì„¸ìš”", options: [{ text: "ì§„ì •í•œ ì´í•´ì™€ ê¹Šì€ ê³µê°ì„ ë°›ëŠ” ê²ƒ", keywords: ["ì˜í˜¼ì˜ê³µê°", "ì§„ì •í•œì´í•´", "ë§ˆìŒì˜ê³µëª…"], weight: "deep_understanding" }, { text: "ë‚´ë©´ì˜ í‰í™”ì™€ ë§ˆìŒì˜ ì•ˆì •ì„ ì°¾ëŠ” ê²ƒ", keywords: ["ë‚´ë©´í‰í™”", "ë§ˆìŒì˜ì•ˆì‹", "ì˜í˜¼ì˜íœ´ì‹"], weight: "inner_peace" }, { text: "ìƒˆë¡œìš´ ë„ì „ê³¼ ì„±ì¥ì˜ ê¸°íšŒë¥¼ ë§Œë‚˜ëŠ” ê²ƒ", keywords: ["ì„±ì¥ì˜ê¸°íšŒ", "ë„ì „ì˜ìš©ê¸°", "ìƒˆë¡œìš´ì‹œì‘"], weight: "growth_opportunity" }, { text: "ìì‹ ë§Œì˜ íŠ¹ë³„í•œ ì˜ë¯¸ì™€ ëª©ì ì„ ë°œê²¬í•˜ëŠ” ê²ƒ", keywords: ["ì‚¶ì˜ëª©ì ", "ì¡´ì¬ì˜ì˜ë¯¸", "ë‚˜ë§Œì˜ê¸¸"], weight: "life_purpose" }]}
        ],
        personalityTypes: {
             cosmic_wonder: { name: "ì˜í˜¼ì˜ íƒí—˜ê°€", description: "ë‹¹ì‹ ì˜ ë§ˆìŒì€ ê´‘í™œí•œ ìš°ì£¼ë¥¼ ë‹®ì•„, ëŠ˜ ê²½ì´ë¡œì›€ê³¼ ì§€ì  í˜¸ê¸°ì‹¬ìœ¼ë¡œ ë¹›ë‚©ë‹ˆë‹¤. í‰ë²”í•¨ ì†ì—ì„œ ë¹„ë²”í•¨ì„ ë°œê²¬í•˜ë©°, ì¡´ì¬ì˜ ê·¼ì›ì„ íƒêµ¬í•˜ëŠ” ì—¬ì • ìì²´ë¥¼ ì¦ê¹ë‹ˆë‹¤." },
             humble_depth: { name: "ê³ ìš”í•œ í˜„ì", description: "ê¹Šì€ ë°”ë‹¤ì²˜ëŸ¼ ê²‰ìœ¼ë¡œëŠ” ì”ì”í•˜ì§€ë§Œ, ë‚´ë©´ì—ëŠ” ì§€í˜œì™€ ì„±ì°°ì˜ ë³´ë¬¼ë“¤ì„ í’ˆê³  ìˆìŠµë‹ˆë‹¤. í™”ë ¤í•¨ë³´ë‹¤ëŠ” ì§„ì‹¤ë¨ì„, ë§ë³´ë‹¤ëŠ” ì¹¨ë¬µì˜ ë¬´ê²Œë¥¼ ì•„ëŠ” ê¹Šì´ ìˆëŠ” ì˜í˜¼ì…ë‹ˆë‹¤." },
             wandering_soul: { name: "ììœ ë¡œìš´ ë°”ëŒ", description: "ì–´ë””ì—ë„ ì–½ë§¤ì´ì§€ ì•ŠëŠ” ë°”ëŒì²˜ëŸ¼, ë‹¹ì‹ ì˜ ì˜í˜¼ì€ ììœ ë¥¼ ê°ˆë§í•©ë‹ˆë‹¤. ìƒˆë¡œìš´ ê²½í—˜ê³¼ ë‚¯ì„  ì¥ì†Œë¥¼ í–¥í•œ ì´ëŒë¦¼ì€ ë‹¹ì‹ ì˜ ì‚¶ì„ ë‹¤ì±„ë¡œìš´ ëª¨í—˜ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤." },
             serene_peace: { name: "í‰ì˜¨ì˜ ì •ì›ì‚¬", description: "ë‹¹ì‹ ì€ ë§ˆìŒì†ì— ê³ ìš”í•œ ì •ì›ì„ ê°€ê¾¸ëŠ” ì‚¬ëŒì…ë‹ˆë‹¤. ì„¸ìƒì˜ ì†ŒìŒ ì†ì—ì„œë„ ë‚´ë©´ì˜ í‰í™”ë¥¼ ì§€í‚¤ëŠ” ë²•ì„ ì•Œë©°, ë‹¹ì‹ ì˜ ì¡´ì¬ ìì²´ê°€ ì£¼ë³€ì— ì•ˆì •ê°ê³¼ ìœ„ì•ˆì„ ì¤ë‹ˆë‹¤." },
             creative_flow: { name: "ì°½ì¡°ì˜ ì—°ê¸ˆìˆ ì‚¬", description: "ë‹¹ì‹ ì€ ê°ì •ê³¼ ê²½í—˜ì„ ë…¹ì—¬ ìƒˆë¡œìš´ ê²ƒì„ ë¹šì–´ë‚´ëŠ” ì˜ˆìˆ ê°€ì…ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì†ëì—ì„œ, ë‹¹ì‹ ì˜ ìƒê° ì†ì—ì„œ ì„¸ìƒì€ ë” ì•„ë¦„ë‹µê³  ì˜ë¯¸ ìˆëŠ” ê²ƒìœ¼ë¡œ ì¬íƒ„ìƒí•©ë‹ˆë‹¤." },
             deep_connection: { name: "ë§ˆìŒì˜ ì—°ê²°ì", description: "ë‹¹ì‹ ì—ê²Œ ê°€ì¥ ì†Œì¤‘í•œ ê²ƒì€ ì‚¬ëŒê³¼ ì‚¬ëŒ ì‚¬ì´ì˜ ì§„ì‹¤í•œ ìœ ëŒ€ì…ë‹ˆë‹¤. ê¹Šì€ ê³µê° ëŠ¥ë ¥ìœ¼ë¡œ íƒ€ì¸ì˜ ë§ˆìŒì„ í—¤ì•„ë¦¬ê³ , ì˜ë¯¸ ìˆëŠ” ê´€ê³„ ì†ì—ì„œ ì‚¶ì˜ ê¸°ì¨ì„ ì°¾ìŠµë‹ˆë‹¤." },
             existential_inquiry: { name: "ì§„ë¦¬ì˜ êµ¬ë„ì", description: "ë‹¹ì‹ ì€ 'ì™œ?'ë¼ëŠ” ì§ˆë¬¸ì„ ë©ˆì¶”ì§€ ì•ŠëŠ” ì² í•™ìì…ë‹ˆë‹¤. ì‚¶ì˜ ì˜ë¯¸ì™€ ì¡´ì¬ì˜ ë³¸ì§ˆì— ëŒ€í•œ ëŠì„ì—†ëŠ” íƒêµ¬ë¥¼ í†µí•´ ìì‹ ë§Œì˜ í•´ë‹µì„ ì°¾ì•„ë‚˜ê°€ëŠ” ì—¬ì • ìœ„ì— ì„œ ìˆìŠµë‹ˆë‹¤." },
             // ë” ë§ì€ ìœ í˜• ì¶”ê°€ ê°€ëŠ¥...
        },

        // --- 2. STATE MANAGEMENT ---
        state: {
            currentQuestionIndex: 0,
            answers: {},
            personalityScores: {},
            userKeywords: [],
        },

        // --- 3. DOM ELEMENTS ---
        dom: {
            mainContent: null,
        },

        // --- 4. INITIALIZATION ---
        init() {
            this.dom.mainContent = document.getElementById('main-content');
            this.initParticles();
            this.resetState();
            this.showWelcome();
        },
        
        resetState() {
            this.state.currentQuestionIndex = 0;
            this.state.answers = {};
            this.state.personalityScores = {};
            this.state.userKeywords = new Set();
        },

        initParticles() {
            if (typeof particlesJS !== 'undefined') {
                particlesJS('particles-js', {
                    "particles": { "number": { "value": 60, "density": { "enable": true, "value_area": 800 } }, "color": { "value": "#ffffff" }, "shape": { "type": "circle" }, "opacity": { "value": 0.3, "random": true, "anim": { "enable": true, "speed": 1, "opacity_min": 0.1, "sync": false } }, "size": { "value": 2, "random": true }, "line_linked": { "enable": false }, "move": { "enable": true, "speed": 0.5, "direction": "none", "random": true, "straight": false, "out_mode": "out", "bounce": false } },
                    "interactivity": { "detect_on": "canvas", "events": { "onhover": { "enable": false }, "onclick": { "enable": false }, "resize": true } },
                    "retina_detect": true
                });
            }
        },
        
        // --- 5. UI RENDERING ---
        showWelcome() {
            this.dom.mainContent.innerHTML = `
                <div style="text-align: center; margin: auto; animation: fadeIn 1s ease-out;">
                    <p style="font-family: 'Noto Serif KR', serif; font-size: 20px; line-height: 1.6; margin-bottom: 24px;">
                        ë‹¹ì‹ ì˜ ë§ˆìŒ ê¹Šì€ ê³³ì—ëŠ”<br>ì–´ë–¤ ì´ì•¼ê¸°ê°€ ìˆ¨ì–´ìˆì„ê¹Œìš”?
                    </p>
                    <p style="color: var(--text-secondary); margin-bottom: 32px;">
                        ì ì‹œ ì‹œê°„ì„ ë‚´ì–´ ë‹¹ì‹ ì˜ ë‚´ë©´ì„ ë“¤ì—¬ë‹¤ë³´ëŠ”<br>ê³ ìš”í•œ ì—¬ì •ì„ ì‹œì‘í•©ë‹ˆë‹¤.
                    </p>
                    <button class="btn" id="start-btn">ì—¬ì • ì‹œì‘í•˜ê¸°</button>
                </div>
            `;
            document.getElementById('start-btn').addEventListener('click', () => this.showQuestion(0));
        },

        showQuestion(index) {
            const question = this.questions[index];
            const progress = (index / this.questions.length) * 100;

            this.dom.mainContent.innerHTML = `
                <div class="progress-container">
                    <div class="progress-bar">
                        <div id="progress-fill" style="width: ${progress}%"></div>
                    </div>
                    <div id="progress-text">ì§ˆë¬¸ ${index + 1} / ${this.questions.length}</div>
                </div>
                <div class="question-container">
                    <div id="question-number">Question ${String(index + 1).padStart(2, '0')}</div>
                    <h2 id="question-box">${question.question}</h2>
                    <p id="question-description">${question.description}</p>
                </div>
                <div id="answer-box"></div>
                <div class="navigation">
                    <button class="btn btn-secondary" id="prev-btn" style="visibility: ${index > 0 ? 'visible' : 'hidden'}">ì´ì „</button>
                    <button class="btn" id="next-btn">${index === this.questions.length - 1 ? 'ê²°ê³¼ ë¶„ì„í•˜ê¸°' : 'ë‹¤ìŒ'}</button>
                </div>
            `;
            
            const answerBox = document.getElementById('answer-box');
            if (question.type === 'choice') {
                const optionsContainer = document.createElement('div');
                optionsContainer.className = 'choice-options';
                question.options.forEach(option => {
                    const optionEl = document.createElement('div');
                    optionEl.className = 'choice-option';
                    optionEl.innerHTML = `<span class="option-text">${option.text}</span>`;
                    optionEl.addEventListener('click', () => {
                        this.handleChoiceSelection(question, option, optionEl);
                    });
                    optionsContainer.appendChild(optionEl);
                });
                answerBox.appendChild(optionsContainer);
            } else if (question.type === 'text') {
                const textarea = document.createElement('textarea');
                textarea.placeholder = 'ë‹¹ì‹ ì˜ ì§„ì†”í•œ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ì£¼ì„¸ìš”...';
                textarea.addEventListener('input', () => {
                    this.state.answers[question.id] = { type: 'text', answer: textarea.value, keywords: question.keywords };
                });
                answerBox.appendChild(textarea);
            }
            
            document.getElementById('next-btn').addEventListener('click', () => this.navigateNext());
            document.getElementById('prev-btn').addEventListener('click', () => this.navigatePrev());
        },

        showLoading() {
            this.dom.mainContent.innerHTML = `
                <div class="loading-screen">
                    <div class="compass-loader">
                        <div class="compass-bg"></div>
                        <div class="compass-needle"></div>
                        <div class="compass-center"></div>
                    </div>
                    <div class="loading-text">ë‹¹ì‹ ì˜ ë§ˆìŒ ì§€ë„ë¥¼ ê·¸ë¦¬ê³  ìˆìŠµë‹ˆë‹¤...</div>
                    <p class="loading-subtext">AIê°€ ë‹¹ì‹ ì˜ ë‹µë³€ì„ ì„¬ì„¸í•˜ê²Œ ë¶„ì„í•˜ì—¬<br>ê°œì¸í™”ëœ ê²°ê³¼ë¥¼ ì°½ì¡°í•©ë‹ˆë‹¤.</p>
                </div>
            `;
            setTimeout(() => this.showResults(), 4000);
        },

        showResults() {
            const analysis = this.generatePersonalizedAnalysis();
            this.dom.mainContent.innerHTML = `
                <div class="result-container">
                    <div class="result-header">
                        <h2 class="result-title">${analysis.title}</h2>
                        <p class="result-metaphor">"${analysis.metaphor}"</p>
                    </div>

                    <div class="result-summary">
                        ${analysis.sortedTraits.map(trait => `
                            <div class="trait-bar">
                                <span class="trait-name">${this.personalityTypes[trait.trait]?.name || trait.trait}</span>
                                <div class="trait-progress-bg">
                                    <div class="trait-progress-fill" style="width: 0%;" data-width="${trait.percentage}%"></div>
                                </div>
                            </div>
                        `).join('')}
                    </div>

                    <div id="accordion-container" style="margin-top: 32px;">
                        <div class="accordion-item">
                            <div class="accordion-header"><h3>ğŸ—ºï¸ ë‹¹ì‹ ì˜ ë§ˆìŒ ì§€ë„</h3><span class="accordion-arrow">â–¼</span></div>
                            <div class="accordion-content">
                                <div class="accordion-content-inner">
                                    ${analysis.mindscape}
                                    <div class="keywords-container">
                                        ${[...this.state.userKeywords].slice(0, 7).map(k => `<span class="keyword">#${k}</span>`).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <div class="accordion-header"><h3>ğŸ—£ï¸ ë‚´ë©´ì˜ ëª©ì†Œë¦¬</h3><span class="accordion-arrow">â–¼</span></div>
                            <div class="accordion-content">
                                <div class="accordion-content-inner">${analysis.deepAnalysis}</div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <div class="accordion-header"><h3>ğŸŒ± ì„±ì¥ì˜ ì—¬ì •</h3><span class="accordion-arrow">â–¼</span></div>
                            <div class="accordion-content">
                                <div class="accordion-content-inner">${analysis.growthGuidance}</div>
                            </div>
                        </div>
                    </div>

                    <div class="share-section">
                        <h4>ì´ ì—¬ì •ì„ ì¹œêµ¬ì™€ í•¨ê»˜ ë‚˜ëˆ„ì–´ë³´ì„¸ìš”</h4>
                        <div class="share-buttons">
                            <button class="btn kakao-btn">ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ê³µìœ í•˜ê¸°</button>
                            <button class="btn btn-secondary" onclick="MindCompassApp.restartSurvey()">ë‹¤ì‹œ ì§„ë‹¨ë°›ê¸°</button>
                        </div>
                    </div>
                </div>
            `;
            this.setupResultInteractions();
        },
        
        // --- 6. EVENT HANDLING & LOGIC ---
        handleChoiceSelection(question, option, element) {
            document.querySelectorAll('.choice-option.selected').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected');
            this.state.answers[question.id] = { type: 'choice', answer: option.text, weight: option.weight, keywords: option.keywords };
        },

        navigateNext() {
            if (!this.state.answers[this.questions[this.state.currentQuestionIndex].id]) {
                alert('ë‹µë³€ì„ ì„ íƒí•˜ê±°ë‚˜ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (this.state.currentQuestionIndex < this.questions.length - 1) {
                this.state.currentQuestionIndex++;
                this.showQuestion(this.state.currentQuestionIndex);
            } else {
                this.showLoading();
            }
        },

        navigatePrev() {
            if (this.state.currentQuestionIndex > 0) {
                this.state.currentQuestionIndex--;
                this.showQuestion(this.state.currentQuestionIndex);
            }
        },
        
        setupResultInteractions() {
            // Animate progress bars
            document.querySelectorAll('.trait-progress-fill').forEach(el => {
                setTimeout(() => { el.style.width = el.dataset.width; }, 300);
            });

            // Accordion logic
            const accordionItems = document.querySelectorAll('.accordion-item');
            accordionItems.forEach(item => {
                const header = item.querySelector('.accordion-header');
                const content = item.querySelector('.accordion-content');
                header.addEventListener('click', () => {
                    const isActive = item.classList.contains('active');
                    accordionItems.forEach(i => {
                        i.classList.remove('active');
                        i.querySelector('.accordion-content').style.maxHeight = '0px';
                        i.querySelector('.accordion-content').style.paddingTop = '0';
                        i.querySelector('.accordion-content').style.paddingBottom = '0';
                    });
                    if (!isActive) {
                        item.classList.add('active');
                        content.style.maxHeight = content.scrollHeight + 'px';
                        content.style.paddingTop = '0';
                        content.style.paddingBottom = '24px';
                    }
                });
            });
            
            // Auto open first accordion
            if (accordionItems.length > 0) {
                setTimeout(() => {
                    accordionItems[0].querySelector('.accordion-header').click();
                }, 500);
            }
        },

        restartSurvey() {
            if(confirm("ìƒˆë¡œìš´ ë§ˆìŒì˜ ì—¬ì •ì„ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                this.resetState();
                this.dom.mainContent.style.animation = 'fadeOut 0.5s ease-out both';
                setTimeout(() => {
                    this.dom.mainContent.style.animation = 'fadeIn 0.5s ease-in both';
                    this.showWelcome();
                }, 500);
            }
        },
        
        // --- 7. ANALYSIS LOGIC (The "AI" Core) ---
        generatePersonalizedAnalysis() {
            // 1. Calculate scores and gather keywords
            this.state.personalityScores = {};
            this.state.userKeywords.clear();
            Object.values(this.state.answers).forEach(ans => {
                if (ans.weight) {
                    this.state.personalityScores[ans.weight] = (this.state.personalityScores[ans.weight] || 0) + 1;
                }
                if (ans.keywords) {
                    ans.keywords.forEach(k => this.state.userKeywords.add(k));
                }
            });

            // 2. Sort traits by score
            const sortedTraits = Object.entries(this.state.personalityScores)
                .map(([trait, score]) => ({ trait, score }))
                .sort((a, b) => b.score - a.score);

            if (sortedTraits.length === 0) {
                // Handle case with no scorable answers by assigning a default
                sortedTraits.push({trait: 'serene_peace', score: 1});
            }

            const primaryTrait = sortedTraits[0];
            const secondaryTrait = sortedTraits.length > 1 ? sortedTraits[1] : null;
            
            // Calculate percentages for summary bars
            const totalScore = sortedTraits.reduce((sum, t) => sum + t.score, 0);
            sortedTraits.forEach(t => {
                t.percentage = Math.round((t.score / totalScore) * 100);
            });


            // 3. Generate content based on top traits
            const pType = this.personalityTypes[primaryTrait.trait];
            const sType = secondaryTrait ? this.personalityTypes[secondaryTrait.trait] : null;

            const analysis = {
                title: pType.name,
                metaphor: this.generateMetaphor(pType, sType),
                mindscape: this.generateMindscape(pType, sType),
                deepAnalysis: this.generateDeepAnalysis(pType, sType),
                growthGuidance: this.generateGrowthGuidance(pType, sType),
                sortedTraits: sortedTraits.slice(0, 3) // Show top 3 traits
            };

            return analysis;
        },

        generateMetaphor(p, s) {
            const metaphors = {
                cosmic_wonder: "ìš°ì£¼ì˜ ë¹„ë°€ì„ í’ˆê³  ì€í•˜ìˆ˜ë¥¼ ê±´ë„ˆëŠ” ì—¬í–‰ì",
                humble_depth: "ê¹Šì€ ë°”ë‹¤ì˜ ì¹¨ë¬µìœ¼ë¡œ ì„¸ìƒì„ í’ˆëŠ” ì§„ì£¼",
                wandering_soul: "ê²½ê³„ ì—†ëŠ” í•˜ëŠ˜ì„ ì§‘ìœ¼ë¡œ ì‚¼ëŠ” ììœ ë¡œìš´ ìƒˆ",
                serene_peace: "ê³ ìš”í•œ ë‹¬ë¹› ì•„ë˜ ëª¨ë“  ê²ƒì„ ë¹„ì¶”ëŠ” í˜¸ìˆ˜",
                creative_flow: "ì„¸ìƒì˜ ë¹›ê³¼ ê·¸ë¦¼ìë¡œ ì‹œë¥¼ ì“°ëŠ” ì˜ˆìˆ ê°€",
                deep_connection: "ì„¬ê³¼ ì„¬ì„ ì‡ëŠ” ë”°ëœ»í•˜ê³  ê²¬ê³ í•œ ë‹¤ë¦¬",
                existential_inquiry: "ì•ˆê°œ ë‚€ ìˆ²ì†ì—ì„œ ìì‹ ë§Œì˜ ê¸¸ì„ ì°¾ëŠ” ìˆœë¡€ì"
            };
            return s ? `${metaphors[p.name]}ì´ë©´ì„œ, ë•Œë¡œëŠ” ${metaphors[s.name]}ì˜ ë§ˆìŒìœ¼ë¡œ ì„¸ìƒì„ ë°”ë¼ë´…ë‹ˆë‹¤.` : metaphors[p.name] + "ì²˜ëŸ¼, ìì‹ ë§Œì˜ ì†ë„ë¡œ ì„¸ìƒì„ ì‚´ì•„ê°‘ë‹ˆë‹¤.";
        },
        
        generateMindscape(p, s) {
            let text = p.description;
            if (s) {
                text += ` ë™ì‹œì—, ë‹¹ì‹ ì—ê²ŒëŠ” ${s.name}ì˜ ë©´ëª¨ë„ ê¹ƒë“¤ì–´ ìˆìŠµë‹ˆë‹¤. ${s.description.split('.')[0]}. ì´ëŸ¬í•œ ë‘ ê°€ì§€ ëª¨ìŠµì´ ì–´ìš°ëŸ¬ì ¸ ë‹¹ì‹ ë§Œì˜ ë…íŠ¹í•˜ê³  ê¹Šì´ ìˆëŠ” ë§ˆìŒì˜ í’ê²½ì„ ë§Œë“¤ì–´ëƒ…ë‹ˆë‹¤.`;
            }
            return text;
        },

        generateDeepAnalysis(p, s) {
            const analyses = {
                cosmic_wonder: "ë‹¹ì‹ ì€ í˜„ìƒì˜ í‘œë©´ ë„ˆë¨¸ì— ìˆëŠ” ë³¸ì§ˆê³¼ ì˜ë¯¸ë¥¼ ê°ˆë§í•©ë‹ˆë‹¤. ì´ ì§€ì  íƒêµ¬ì‹¬ì€ ë•Œë¡œ ë‹¹ì‹ ì„ ê³ ë…í•˜ê²Œ ë§Œë“¤ì§€ë§Œ, ê·¸ ê³ ë…ì´ì•¼ë§ë¡œ ë‹¹ì‹ ì˜ ì˜í˜¼ì„ ì‚´ì°Œìš°ëŠ” ìì–‘ë¶„ì…ë‹ˆë‹¤.",
                humble_depth: "ìì‹ ì„ ë“œëŸ¬ë‚´ê¸°ë³´ë‹¤ ë¬µë¬µíˆ ìì‹ ì˜ ìë¦¬ë¥¼ ì§€í‚¤ëŠ” ë‹¹ì‹ ì˜ ëª¨ìŠµì—ì„œ ì‚¬ëŒë“¤ì€ ì§„ì •í•œ ê°•ì¸í•¨ì„ ëŠë‚ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ê²¸ì†ì€ ì•½í•¨ì´ ì•„ë‹Œ, ëª¨ë“  ê²ƒì„ ì´í•´í•˜ê³  í¬ìš©í•˜ëŠ” ê¹Šì´ì˜ ë‹¤ë¥¸ ì´ë¦„ì…ë‹ˆë‹¤.",
                wandering_soul: "ë‹¹ì‹ ì—ê²Œ ì‚¶ì€ ì •ì°©ì´ ì•„ë‹Œ ì—¬ì •ì…ë‹ˆë‹¤. ì•ˆì •ë³´ë‹¤ëŠ” ì„±ì¥ì„, ì†Œìœ ë³´ë‹¤ëŠ” ê²½í—˜ì„ ì¶”êµ¬í•˜ëŠ” ë‹¹ì‹ ì˜ ì‚¶ì€ ê·¸ ìì²´ë¡œ í•œ í¸ì˜ ë¡œë“œë¬´ë¹„ì™€ ê°™ìŠµë‹ˆë‹¤.",
                serene_peace: "ê°ˆë“±ì„ í”¼í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ê°ˆë“± ì†ì—ì„œë„ ë‚´ë©´ì˜ ì¤‘ì‹¬ì„ ì§€í‚¤ëŠ” í˜ì´ ë‹¹ì‹ ì—ê²Œ ìˆìŠµë‹ˆë‹¤. ë‹¹ì‹ ì˜ í‰ì˜¨í•¨ì€ íƒ€ê³ ë‚œ ê²ƒì´ ì•„ë‹ˆë¼, ìˆ˜ë§ì€ íŒŒë„ë¥¼ ê²ªì–´ë‚´ë©° ì–»ì€ ê°’ì§„ ì§€í˜œì…ë‹ˆë‹¤.",
                creative_flow: "ë‹¹ì‹ ì€ ì„¸ìƒì„ ìˆëŠ” ê·¸ëŒ€ë¡œ ë°›ì•„ë“¤ì´ê¸°ë³´ë‹¤, ìì‹ ë§Œì˜ ìƒ‰ê³¼ í˜•íƒœë¡œ ì¬í•´ì„í•˜ê³  í‘œí˜„í•  ë•Œ ì‚´ì•„ìˆìŒì„ ëŠë‚ë‹ˆë‹¤. ì°½ì‘ì˜ ê³¼ì •ì€ ë‹¹ì‹ ì—ê²Œ ê°€ì¥ ê¹Šì€ ëª°ì…ê³¼ ì¹˜ìœ ë¥¼ ì„ ë¬¼í•©ë‹ˆë‹¤.",
                deep_connection: "í‘œë©´ì ì¸ ê´€ê³„ì— ì‰½ê²Œ ë§Œì¡±í•˜ì§€ ëª»í•˜ë©°, ì˜í˜¼ì˜ ê¹Šì€ ê³³ì—ì„œ ì´ë£¨ì–´ì§€ëŠ” ì§„ì •í•œ êµê°ì„ ì¶”êµ¬í•©ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ë”°ëœ»í•œ ê³µê°ì€ ì£¼ë³€ ì‚¬ëŒë“¤ì—ê²Œ ê¹Šì€ ìœ„ë¡œì™€ í˜ì´ ë©ë‹ˆë‹¤.",
                existential_inquiry: "ì •í•´ì§„ ë‹µì„ ë”°ë¥´ê¸°ë³´ë‹¤, ìŠ¤ìŠ¤ë¡œ ì§ˆë¬¸í•˜ê³  íƒìƒ‰í•˜ë©° ê¸¸ì„ ë§Œë“¤ì–´ê°€ëŠ” ê²ƒì— ì‚¶ì˜ ì˜ë¯¸ë¥¼ ë‘¡ë‹ˆë‹¤. ê·¸ ê³¼ì • ì†ì˜ ë°©í™©ê³¼ ê³ ë‡Œì¡°ì°¨ ë‹¹ì‹ ì—ê²ŒëŠ” ì†Œì¤‘í•œ ì„±ì¥ì˜ ì¼ë¶€ì…ë‹ˆë‹¤."
            };
            let text = analyses[p.name];
            if (s) {
                text += ` ì—¬ê¸°ì— ${s.name}ì˜ íŠ¹ì„±ì´ ë”í•´ì ¸, ë‹¹ì‹ ì€ ${this.getSynergyText(p.name, s.name)}.`;
            }
            return text;
        },

        generateGrowthGuidance(p, s) {
            const guidances = {
                cosmic_wonder: "ê°€ë”ì€ ë¨¸ë¦¬ì—ì„œ ê°€ìŠ´ìœ¼ë¡œ ì‹œì„ ì„ ì˜®ê²¨, ë‹¹ì‹ ì´ ë°œê²¬í•œ ìš°ì£¼ì˜ ì§€í˜œë¥¼ í˜„ì‹¤ì˜ ì‚¶ê³¼ ë”°ëœ»í•˜ê²Œ ì—°ê²°í•´ë³´ì„¸ìš”. ë‹¹ì‹ ì˜ í†µì°°ì´ ë‹¤ë¥¸ ì´ë“¤ì—ê²Œë„ ë¹›ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
                humble_depth: "ë‹¹ì‹ ì˜ ê¹Šì€ ì§€í˜œì™€ í†µì°°ì€ ì„¸ìƒì— ê¼­ í•„ìš”í•œ ì„ ë¬¼ì…ë‹ˆë‹¤. ë•Œë¡œëŠ” ì¹¨ë¬µì„ ê¹¨ê³  ë‹¹ì‹ ì˜ ëª©ì†Œë¦¬ë¥¼ ë‚´ì–´, ê·¸ ì„ ë¬¼ì„ ë‹¤ë¥¸ ì´ë“¤ê³¼ ë‚˜ëˆ„ëŠ” ìš©ê¸°ë¥¼ ê°€ì ¸ë³´ì„¸ìš”.",
                wandering_soul: "ììœ ë¡œìš´ ë¹„í–‰ ì†ì—ì„œë„ ì ì‹œ ì‰¬ì–´ê°ˆ ìˆ˜ ìˆëŠ” ë‹¹ì‹ ë§Œì˜ ë‘¥ì§€ë¥¼ ë§Œë“œëŠ” ê²ƒì„ ìŠì§€ ë§ˆì„¸ìš”. ë¿Œë¦¬ë‚´ë¦¼ì€ êµ¬ì†ì´ ì•„ë‹ˆë¼, ë” ë†’ì´ ë‚ ê¸° ìœ„í•œ ì—ë„ˆì§€ë¥¼ ì–»ëŠ” ê³¼ì •ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
                serene_peace: "ë‹¹ì‹ ì˜ í‰í™”ëŠ” ì†Œì¤‘í•˜ì§€ë§Œ, ë•Œë¡œëŠ” ë‹¹ì‹ ì˜ ê²½ê³„ë¥¼ ì§€í‚¤ê¸° ìœ„í•´ 'ì•„ë‹ˆì˜¤'ë¼ê³  ë§í•˜ëŠ” ê±´ê°•í•œ íŒŒë„ë¥¼ ì¼ìœ¼í‚¬ í•„ìš”ë„ ìˆìŠµë‹ˆë‹¤. ì§„ì •í•œ í‰í™”ëŠ” ì§€í‚´ìœ¼ë¡œì¨ ì™„ì„±ë©ë‹ˆë‹¤.",
                creative_flow: "ì™„ë²½í•œ ê²°ê³¼ë¬¼ì— ëŒ€í•œ ë¶€ë‹´ì„ ë‚´ë ¤ë†“ê³ , ì°½ì‘ ê³¼ì • ìì²´ì˜ ì¦ê±°ì›€ì„ ì˜¨ì „íˆ ëˆ„ë ¤ë³´ì„¸ìš”. ë‹¹ì‹ ì˜ ê°€ì¥ ì§„ì†”í•œ ì´ì•¼ê¸°ê°€ ë‹´ê¸¸ ë•Œ, ì‘í’ˆì€ ê°€ì¥ í° ìš¸ë¦¼ì„ ê°–ê²Œ ë©ë‹ˆë‹¤.",
                deep_connection: "íƒ€ì¸ì„ í–¥í•œ ê¹Šì€ ê³µê°ë§Œí¼, ìê¸° ìì‹ ì„ í–¥í•œ ë”°ëœ»í•œ ì´í•´ì™€ ë³´ì‚´í•Œì—ë„ ì‹œê°„ì„ ë‚´ì–´ì£¼ì„¸ìš”. ìŠ¤ìŠ¤ë¡œì™€ ê¹Šì´ ì—°ê²°ë  ë•Œ, ë‹¹ì‹ ì˜ ê´€ê³„ëŠ” ë”ìš± ê±´ê°•í•˜ê²Œ ë¹›ë‚  ê²ƒì…ë‹ˆë‹¤.",
                existential_inquiry: "ë•Œë¡œëŠ” ëª…í™•í•œ ë‹µì„ ì°¾ì§€ ëª»í•´ë„ ê´œì°®ìŠµë‹ˆë‹¤. ì¤‘ìš”í•œ ê²ƒì€ ì§ˆë¬¸ì„ ë©ˆì¶”ì§€ ì•ŠëŠ” ë‹¹ì‹ ì˜ íƒœë„ ê·¸ ìì²´ì…ë‹ˆë‹¤. ê¸¸ ìœ„ì—ì„œì˜ ëª¨ë“  ìˆœê°„ì´ ë‹¹ì‹ ì˜ ì¼ë¶€ì„ì„ ë¯¿ì–´ì£¼ì„¸ìš”."
            };
            return guidances[p.name];
        },
        
        getSynergyText(p_name, s_name) {
            // ë‘ íŠ¹ì„±ì˜ ì‹œë„ˆì§€ë¥¼ í‘œí˜„í•˜ëŠ” ë¬¸ì¥ (ê°„ë‹¨í•œ ì˜ˆì‹œ)
            const synergyMap = {
                "ì˜í˜¼ì˜ íƒí—˜ê°€_ê³ ìš”í•œ í˜„ì": "ìš°ì£¼ì  ì‚¬ìœ ë¥¼ í•˜ë©´ì„œë„ ë‚´ë©´ì˜ ê¹Šì´ë¥¼ ìƒì§€ ì•ŠëŠ” ê· í˜• ì¡íŒ ëª¨ìŠµì„ ë³´ì…ë‹ˆë‹¤",
                "ììœ ë¡œìš´ ë°”ëŒ_ì°½ì¡°ì˜ ì—°ê¸ˆìˆ ì‚¬": "ììœ ë¡œìš´ ì˜í˜¼ìœ¼ë¡œ ì„¸ìƒì„ íƒí—˜í•˜ë©° ì–»ì€ ì˜ê°ì„ ë…ì°½ì ì¸ ì˜ˆìˆ ë¡œ ìŠ¹í™”ì‹œí‚¤ëŠ” ëŠ¥ë ¥ì´ íƒì›”í•©ë‹ˆë‹¤"
            };
            return synergyMap[`${p_name}_${s_name}`] || "ë³µí•©ì ì¸ ë§¤ë ¥ì„ ì§€ë‹Œ ì‚¬ëŒì…ë‹ˆë‹¤";
        }
    };

    document.addEventListener('DOMContentLoaded', () => {
        MindCompassApp.init();
    });
    //]]>
    </script>
</body>
</html>
