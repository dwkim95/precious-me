<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>마음의 나침반 | AI가 그려주는 당신의 마음 지도</title>
    <meta name="description" content="AI 심해 탐사선 '아스트라'와 함께 당신의 마음 가장 깊은 곳을 탐험하고, 영혼의 원형과 치유의 주문을 발견하세요.">
    <meta property="og:title" content="마음의 나침반 - AI 심층 심리 분석">
    <meta property="og:description" content="AI가 당신의 답변을 통해 섬세한 마음 지도를 그려드립니다. 당신의 영혼은 어떤 풍경을 담고 있을까요?">
    <meta property="og:image" content="https://i.ibb.co/3k5JqB4/og-image-compass.png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&family=Noto+Serif+KR:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --surface-color-1: #1E2940; /* 표면 */
            --surface-color-2: #141D34; /* 어스름 */
            --surface-color-3: #0A1122; /* 심연 */
            --text-primary: #E6EEFF;
            --text-secondary: #A0AEC0;
            --text-accent: #90BFFF;
            --accent-glow: #82B8FF;
            --accent-warm: #FFC0CB;
            --border-radius: 20px;
            --transition-smooth: all 0.6s cubic-bezier(0.25, 1, 0.5, 1);
        }

        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--surface-color-1);
            color: var(--text-primary);
            line-height: 1.8;
            overflow: hidden;
            transition: background-color 1s ease;
        }

        #app {
            max-width: 600px;
            margin: 0 auto;
            padding: 24px;
            position: relative;
            z-index: 1;
            min-height: 100vh;
        }
        
        .fade-in { animation: fadeIn 1.2s ease-out both; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .header { text-align: center; margin-bottom: 40px; }
        .header h1 { font-family: 'Noto Serif KR', serif; font-size: 36px; font-weight: 700; }
        .header .subtitle { font-size: 18px; color: var(--text-secondary); }
        .header .start-button {
            margin-top: 30px;
            padding: 16px 36px;
            font-size: 18px;
            font-weight: 700;
            background-color: var(--text-accent);
            color: var(--surface-color-3);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .header .start-button:hover { transform: scale(1.05); box-shadow: 0 0 20px var(--accent-glow); }

        .progress-container { margin-bottom: 24px; width: 100%; }
        .progress-bar { width: 100%; height: 4px; background: rgba(255,255,255,0.1); border-radius: 2px; }
        #progress-fill { height: 100%; background: var(--text-accent); border-radius: 2px; transition: width 0.5s ease; }
        #phase-title { font-family: 'Noto Serif KR', serif; font-size: 20px; text-align: center; margin-bottom: 40px; color: var(--text-accent); opacity: 0.7; }

        .question-card {
            background: rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius);
            padding: 32px;
        }
        #question-box { font-family: 'Noto Serif KR', serif; font-size: 24px; font-weight: 600; text-align: center; margin-bottom: 24px; }
        .choice-options { display: flex; flex-direction: column; gap: 16px; }
        .choice-option {
            background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px; padding: 20px; cursor: pointer;
            transition: all 0.3s ease;
        }
        .choice-option:hover { background: rgba(255,255,255,0.1); transform: translateY(-4px); }
        .option-text { font-size: 17px; font-weight: 500; }

        .loading-screen { text-align: center; padding: 80px 0; }
        .loading-text { font-family: 'Noto Serif KR', serif; font-size: 22px; margin-bottom: 16px; }

        /* 결과 페이지 디자인 */
        .result-container { padding-top: 40px; }
        .result-card {
            background: rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius);
            padding: 32px;
            margin-bottom: 24px;
            animation: fadeIn 1s ease-out 0.5s both;
            position: relative;
        }
        .result-card h2 {
            font-family: 'Noto Serif KR', serif;
            font-size: 24px;
            color: var(--text-accent);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
        }
        .result-card h2 .icon { margin-right: 12px; }
        .result-card p, .result-card .text-block { font-size: 17px; line-height: 1.9; color: var(--text-secondary); }
        .archetype-title { font-size: 28px; font-weight: 700; color: var(--text-primary); margin-bottom: 8px; }
        .archetype-subtitle { font-size: 18px; color: var(--accent-warm); font-style: italic; margin-bottom: 20px; }
        
        .light-shadow-container { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
        .light-shadow-box h3 { font-family: 'Noto Serif KR', serif; font-size: 20px; margin-bottom: 12px; }
        .light-shadow-box .light h3 { color: #A7D7C5; } /* 빛 */
        .light-shadow-box .shadow h3 { color: #DAB894; } /* 그림자 */
        .light-shadow-box p { font-size: 16px; }

        .mantra-card {
            text-align: center;
            background: linear-gradient(135deg, rgba(144, 191, 255, 0.1), rgba(255, 192, 203, 0.1));
            padding: 40px;
        }
        .mantra-card .mantra-text {
            font-family: 'Noto Serif KR', serif;
            font-size: 22px;
            font-weight: 600;
            line-height: 1.7;
            color: var(--text-primary);
        }

        .restart-button {
            display: block;
            width: 100%;
            text-align: center;
            margin-top: 32px;
            padding: 16px;
            font-size: 18px;
            font-weight: 700;
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--text-secondary);
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .restart-button:hover { background: var(--text-secondary); color: var(--surface-color-3); }

        /* SVG 아이콘 및 애니메이션 */
        .svg-icon { width: 32px; height: 32px; }
        #mantra-heart-path { animation: heartbeat 2s infinite ease-in-out; transform-origin: center; }
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            10%, 30% { transform: scale(1.1); }
            20% { transform: scale(1.05); }
        }
    </style>
</head>

<body>
    <div id="app">
        </div>

    <script>
    //<![CDATA[
    const MindJourneyApp = {
        // --- 1. CONFIGURATION & DATA ---
        state: {
            currentQuestionIndex: 0,
            answers: {},
            scores: {},
            isNavigating: false,
        },
        
        // 재창조된 질문과 원형 데이터
        questions: [
            // Phase 1: 표면의 바다
            { phase: "Phase 1. 표면의 바다", question: "밤하늘의 별을 바라볼 때,<br>가장 먼저 드는 생각은 무엇인가요?", options: [ { text: "이 광대한 우주의 법칙과 질서에 대한 경외감", weight: "sage" }, { text: "별 너머 어딘가에 있을 미지의 세계에 대한 동경", weight: "explorer" }, { text: "함께 별을 보고 싶은 누군가에 대한 그리움", weight: "lover" }, { text: "그저 모든 것을 잊게 만드는 밤의 고요함", weight: "innocent" } ] },
            { question: "당신에게 '집'이란 어떤 의미에<br>가장 가까운가요?", options: [ { text: "세상의 소음으로부터 나를 지키는 유일한 성역", weight: "innocent" }, { text: "사랑하는 사람들과의 기억이 깃든 따뜻한 공간", weight: "lover" }, { text: "새로운 여정을 떠나기 위해 잠시 머무는 정거장", weight: "explorer" }, { text: "내 안의 창조적 영감을 실현하는 아틀리에", weight: "creator" } ] },
            { question: "당신의 서재에 단 한 종류의 책만<br>꽂을 수 있다면 무엇을 선택하겠어요?", options: [ { text: "세상의 진리와 지혜를 담은 철학서", weight: "sage" }, { text: "가슴 뛰는 모험과 탐험에 대한 여행기", weight: "explorer" }, { text: "다양한 형태의 사랑을 노래하는 시집", weight: "lover" }, { text: "아무것도 쓰여있지 않은, 내가 채워나갈 빈 노트", weight: "creator" } ] },
            // Phase 2: 어스름의 바다
            { phase: "Phase 2. 어스름의 바다", question: "길을 잃은 밤, 당신 손에 들린 등불은<br>어떤 빛을 내고 있나요?", options: [ { text: "나아갈 길을 멀리까지 비추는 단단하고 밝은 빛", weight: "ruler" }, { text: "길의 끝이 아닌, 바로 발밑을 비추는 작은 온기", weight: "innocent" }, { text: "주변의 어둠까지 아름답게 만드는 은은한 빛", weight: "creator" }, { text: "함께 길을 잃은 다른 이를 찾기 위한 신호의 빛", weight: "lover" } ] },
            { question: "깊은 상실감을 마주했을 때,<br>당신은 어떻게 반응하나요?", options: [ { text: "상실의 의미를 이해하고 받아들이려 노력한다", weight: "sage" }, { text: "그 감정을 새로운 창작의 동력으로 승화시킨다", weight: "creator" }, { text: "또 다른 새로움으로 빈자리를 채우기 위해 떠난다", weight: "explorer" }, { text: "그 슬픔이 지나갈 때까지 고요히 나를 돌본다", weight: "innocent" } ] },
            { question: "당신의 가장 오랜 기억은<br>어떤 감각으로 남아있나요?", options: [ { text: "누군가의 따뜻한 손길과 체온", weight: "lover" }, { text: "세상을 처음 발견했을 때의 놀라움과 경이", weight: "explorer" }, { text: "고요한 안정감 속에서 들려오던 심장 박동 소리", weight: "innocent" }, { text: "세상의 이치를 처음 깨달았을 때의 명료함", weight: "sage" } ] },
             // Phase 3: 심연의 바다
            { phase: "Phase 3. 심연의 바다", question: "세상의 모든 규칙 중 단 하나를<br>없앨 수 있다면 무엇을 없애겠어요?", options: [ { text: "사람과 사람을 가로막는 모든 경계선", weight: "lover" }, { text: "진실을 가리는 거짓과 위선", weight: "sage" }, { text: "영혼의 자유를 속박하는 모든 의무", weight: "explorer" }, { text: "세상을 혼란에 빠뜨리는 무질서 그 자체", weight: "ruler" } ] },
            { question: "당신의 가장 깊은 곳에 숨겨진<br>두려움은 무엇인가요?", options: [ { text: "사랑하는 모든 것을 잃고 완전히 혼자가 되는 것", weight: "lover" }, { text: "나의 잠재력을 전부 펼치지 못하고 생을 마감하는 것", weight: "creator" }, { text: "통제할 수 없는 혼돈 속에 무력하게 휩쓸리는 것", weight: "ruler" }, { text: "삶의 의미를 끝내 발견하지 못하는 것", weight: "sage" } ] },
            { question: "당신이 세상에 남기고 싶은<br>궁극적인 흔적은 무엇인가요?", options: [ { text: "세상을 더 나은 방향으로 이끈 시스템과 질서", weight: "ruler" }, { text: "사람들의 마음속에 영원히 남을 아름다운 창작물", weight: "creator" }, { text: "내가 걸어온 용감하고 자유로웠던 발자국 그 자체", weight: "explorer" }, { text: "내가 존재함으로 인해 더 따뜻해진 세상의 온도", weight: "lover" } ] }
        ],
        archetypes: {
            sage: { title: "현자", subtitle: "진리와 지혜를 탐구하는 영혼", light: "당신은 세상의 표면 아래 숨겨진 본질과 질서를 꿰뚫어 보는 깊은 통찰력을 지녔습니다. 혼돈 속에서도 명료함을 잃지 않으며, 당신의 지혜는 자신과 타인의 길을 밝히는 등대가 됩니다.", shadow: "때로는 지나친 사유에 빠져 현실과 멀어지거나, 감정의 가치를 간과하는 경향이 있습니다. 머리의 언어가 마음의 언어를 압도하지 않도록 경계해야 합니다.", mantra: "나의 이해는 세상을 비추는 빛이 됩니다." },
            explorer: { title: "탐험가", subtitle: "미지의 세계를 향해 나아가는 영혼", light: "당신은 얽매이지 않는 자유로운 영혼의 소유자입니다. 미지의 세계를 향한 끝없는 동경과 용기는 당신의 삶을 그 누구보다 다채롭고 풍요로운 모험으로 만듭니다.", shadow: "하나의 세계에 깊이 뿌리내리는 것을 두려워하여, 진정한 안정과 소속감을 놓칠 수 있습니다. 때로는 멈춤이 더 위대한 탐험의 시작임을 기억해야 합니다.", mantra: "나의 길은 세상의 경계 너머로 이어집니다." },
            lover: { title: "연인", subtitle: "연결과 사랑으로 충만한 영혼", light: "당신은 세상의 모든 존재와 깊이 연결되고 사랑을 나눌 때 살아있음을 느낍니다. 당신의 따뜻한 공감과 헌신은 차가운 세상을 녹이는 가장 강력한 힘입니다.", shadow: "타인과의 관계 속에서 자신을 잃어버리거나, 사랑을 잃는 것에 대한 깊은 두려움이 당신을 잠식할 수 있습니다. 가장 먼저 사랑해야 할 존재는 바로 당신 자신입니다.", mantra: "나의 사랑은 세상의 온도를 높입니다." },
            creator: { title: "창조자", subtitle: "무에서 유를 빚어내는 영혼", light: "당신은 세상의 파편들을 모아 새로운 의미와 아름다움을 빚어내는 예술가입니다. 당신의 상상력과 창조성은 황무지에서 꽃을 피우는 기적을 행합니다.", shadow: "완벽함에 대한 강박이 창작의 즐거움을 앗아가거나, 세상이 당신의 비전을 이해하지 못할 때 깊은 고독에 빠질 수 있습니다. 과정 자체의 아름다움을 믿으세요.", mantra: "나의 상상은 새로운 현실을 빚어냅니다." },
            ruler: { title: "통치자", subtitle: "질서와 조화를 구축하는 영혼", light: "당신은 혼돈 속에서 질서를 발견하고, 책임감과 리더십으로 자신과 주변의 세계를 안정적으로 이끌어가는 힘이 있습니다. 당신이 있는 곳에 조화와 번영이 깃듭니다.", shadow: "모든 것을 통제하려는 욕망이 당신을 경직되게 만들거나, 실패에 대한 두려움으로 새로운 도전을 망설일 수 있습니다. 진정한 통치는 때로는 내려놓음에서 시작됩니다.", mantra: "나의 의지는 조화로운 세상을 세웁니다." },
            innocent: { title: "순수주의자", subtitle: "본연의 빛을 간직한 영혼", light: "당신은 세상의 복잡함 속에서도 순수함과 믿음을 잃지 않는 귀한 존재입니다. 당신의 존재 자체가 주변에 안전함과 평화를 선물하며, 근원적인 신뢰의 힘을 보여줍니다.", shadow: "세상의 어두운 면을 마주하는 것을 회피하려 하거나, 상처받는 것에 대한 두려움으로 자신만의 성에 갇힐 수 있습니다. 진정한 순수는 어둠을 알고도 빛을 택하는 용기입니다.", mantra: "나의 순수는 세상을 정화하는 힘입니다." }
        },

        // --- 2. DOM & UI ---
        initDOM() {
            this.app = document.getElementById('app');
            this.renderWelcome();
        },

        renderWelcome() {
            this.app.innerHTML = `<div class="header fade-in"><h1>마음의 나침반</h1><p class="subtitle">AI 심해 탐사선 '아스트라'와 함께<br>당신의 마음 가장 깊은 곳을 향한<br>여정을 시작합니다.</p><button class="header start-button">탐사 시작</button></div>`;
            this.app.querySelector('.start-button').addEventListener('click', () => this.startJourney());
        },

        startJourney() {
            this.resetState();
            this.renderQuestion();
        },
        
        resetState() {
            this.state.currentQuestionIndex = 0;
            this.state.answers = {};
            this.state.scores = {};
            this.state.isNavigating = false;
        },

        renderQuestion() {
            const index = this.state.currentQuestionIndex;
            const q = this.questions[index];
            const progress = ((index + 1) / this.questions.length) * 100;

            const phaseIndex = Math.floor(index / 3);
            document.body.style.backgroundColor = `var(--surface-color-${phaseIndex + 1})`;
            
            this.app.innerHTML = `
                <div class="fade-in">
                    <div class="progress-container">
                        <div class="progress-bar"><div id="progress-fill" style="width:${progress}%"></div></div>
                    </div>
                    ${q.phase ? `<h2 id="phase-title">${q.phase}</h2>` : ''}
                    <div class="question-card">
                        <h3 id="question-box">${q.question}</h3>
                        <div class="choice-options">
                            ${q.options.map(opt => `<div class="choice-option" data-weight="${opt.weight}"><span class="option-text">${opt.text}</span></div>`).join('')}
                        </div>
                    </div>
                </div>
            `;
            this.app.querySelectorAll('.choice-option').forEach(el => {
                el.addEventListener('click', () => this.handleSelection(el.dataset.weight));
            });
        },

        handleSelection(weight) {
            if (this.state.isNavigating) return;
            this.state.isNavigating = true;

            this.state.scores[weight] = (this.state.scores[weight] || 0) + 1;
            
            this.app.querySelector('.fade-in').style.animation = 'fadeOut 0.5s ease-in both';
            
            setTimeout(() => {
                if (this.state.currentQuestionIndex < this.questions.length - 1) {
                    this.state.currentQuestionIndex++;
                    this.renderQuestion();
                    this.state.isNavigating = false;
                } else {
                    this.renderLoading();
                }
            }, 500);
        },
        
        renderLoading() {
            document.body.style.backgroundColor = `var(--surface-color-3)`;
            this.app.innerHTML = `<div class="loading-screen fade-in"><h2 class="loading-text">심해 탐사 기록을 분석 중입니다...</h2><p class="subtitle">AI '아스트라'가 당신의 여정에서<br>의미있는 신호들을 해독하고 있습니다.</p></div>`;
            setTimeout(() => this.renderResults(), 4000);
        },

        renderResults() {
            const analysis = this.analyze();
            const archetype = this.archetypes[analysis.primaryArchetype];

            this.app.innerHTML = `
                <div class="result-container">
                    <div class="result-card" style="animation-delay: 0.5s;">
                        <h2 class="archetype-title">${archetype.title}</h2>
                        <p class="archetype-subtitle">${archetype.subtitle}</p>
                        <p>${archetype.description}</p>
                    </div>

                    <div class="result-card" style="animation-delay: 0.8s;">
                        <h2><span class="icon">✨</span>당신의 빛과 그림자</h2>
                        <div class="light-shadow-container">
                            <div class="light-shadow-box light"><h3>빛 (Light)</h3><p>${archetype.light}</p></div>
                            <div class="light-shadow-box shadow"><h3>그림자 (Shadow)</h3><p>${archetype.shadow}</p></div>
                        </div>
                    </div>

                    <div class="result-card" style="animation-delay: 1.1s;">
                        <h2><span class="icon">🛰️</span>아스트라의 통신</h2>
                        <div class="text-block">${this.getAstraAnalysis(analysis)}</div>
                    </div>

                    <div class="result-card mantra-card" style="animation-delay: 1.4s;">
                         <svg class="svg-icon" viewBox="0 0 24 24" style="width:48px; height:48px; fill: var(--accent-warm); margin-bottom: 20px;">
                            <path id="mantra-heart-path" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                        </svg>
                        <h2>당신을 위한 주문</h2>
                        <p class="mantra-text">"${archetype.mantra}"</p>
                    </div>

                    <button class="restart-button" onclick="MindJourneyApp.initDOM()">다시 탐사하기</button>
                </div>
            `;
            document.body.style.backgroundColor = `var(--surface-color-1)`;
        },
        
        // --- 3. ANALYSIS LOGIC ---
        analyze() {
            const sorted = Object.entries(this.state.scores).sort((a,b) => b[1] - a[1]);
            const primaryArchetype = sorted.length > 0 ? sorted[0][0] : "innocent";
            const secondaryArchetype = sorted.length > 1 ? sorted[1][0] : null;
            return { primaryArchetype, secondaryArchetype, scores: this.state.scores };
        },

        getAstraAnalysis(analysis) {
            const primary = this.archetypes[analysis.primaryArchetype];
            const secondary = this.archetypes[analysis.secondaryArchetype];

            let text = `표면의 바다에서 당신은 ${primary.title}로서의 호기심과 성향을 드러냈습니다. 하지만 여정이 깊어질수록, 어스름의 바다에서는 당신의 숨겨진 그림자가 드러나기 시작했죠. 바로 '${primary.shadow.split('.')[1].trim()}'는 두려움입니다.<br><br>`;
            
            if (secondary) {
                text += `심연 속에서, 당신 안의 또 다른 원형인 ${secondary.title}의 목소리가 들려왔습니다. 이는 당신이 ${primary.title}의 길을 걸으면서도, ${secondary.title}의 시선으로 세상을 바라볼 수 있음을 의미합니다. 이 두 원형의 조화가 당신의 영혼을 더욱 입체적이고 풍요롭게 만듭니다.`;
            } else {
                text += `심연 속에서 당신은 오롯이 ${primary.title}의 원형과 마주했습니다. 당신의 영혼은 한결같이 순수한 빛을 향해 나아가고 있으며, 이것이 당신의 가장 큰 힘이자 위대함입니다.`;
            }
            return text;
        }

    };

    document.addEventListener('DOMContentLoaded', () => {
        MindJourneyApp.initDOM();
    });
    //]]>
    </script>
</body>
</html>
