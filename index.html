<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIND DIVE</title>
    <meta name="description" content="고요한 심연으로의 탐사, 아직 만나지 못한 당신을 발견하세요.">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500&family=Noto+Serif+KR:wght@300;400;500&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #02040a;
            --primary-text: #E5E9F0;
            --secondary-text: #A3B3C6;
            --accent-light: #b0c4ff;
            --accent-deep: #778beb;
            --border-color: rgba(176, 196, 255, 0.1);
            --blur-bg: rgba(18, 24, 41, 0.5);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: var(--bg-color);
            color: var(--primary-text);
            line-height: 1.8;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
            letter-spacing: -0.01em;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: 
                radial-gradient(circle at 15% 25%, rgba(120, 140, 235, 0.07) 0%, transparent 40%),
                radial-gradient(circle at 85% 75%, rgba(176, 196, 255, 0.05) 0%, transparent 40%);
            pointer-events: none;
            z-index: 1;
            animation: pulse 18s infinite alternate ease-in-out;
        }

        @keyframes pulse {
            from { opacity: 0.7; transform: scale(1); }
            to { opacity: 1; transform: scale(1.03); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes dive {
            0% { opacity: 1; transform: translateY(0); }
            50% { opacity: 0; transform: translateY(40px); }
            100% { opacity: 0; transform: translateY(40px); }
        }

        .container {
            max-width: 460px;
            margin: 0 auto;
            padding: 24px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            z-index: 2;
        }

        .screen { display: flex; flex-direction: column; justify-content: center; min-height: 100vh; animation: fadeIn 1.2s ease-out; }

        /* --- 프롤로그 (시작 화면) --- */
        .prologue-title {
            font-family: 'Noto Serif KR', serif;
            font-size: 2.5rem;
            font-weight: 400;
            letter-spacing: 0.05em;
            text-align: center;
            background: linear-gradient(135deg, #e0e6f1 0%, #a5b4fc 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 40px;
        }
        .intro-text {
            font-family: 'Noto Serif KR', serif;
            font-size: 1.1rem;
            color: #d1d9e6;
            text-align: justify;
            margin-bottom: 48px;
            font-weight: 300;
            word-break: keep-all;
        }
        .intro-text strong { font-weight: 500; color: var(--primary-text); }
        .btn-primary {
            width: 100%;
            padding: 18px 32px;
            background: linear-gradient(135deg, var(--accent-deep) 0%, #3b82f6 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.05rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(119, 139, 235, 0.2);
            letter-spacing: 0.05em;
        }
        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 12px 30px rgba(59, 130, 246, 0.3); }

        /* --- 잠수 화면 --- */
        .diving-screen { text-align: center; animation: dive 2s forwards; }
        .diving-screen p { font-family: 'Noto Serif KR', serif; font-size: 1.1rem; color: var(--secondary-text); }
        .diving-screen .depth { font-size: 1.5rem; color: var(--primary-text); font-weight: 400; display: block; margin-top: 8px; }

        /* --- 질문 화면 --- */
        .progress-section { margin-bottom: 32px; }
        .depth-indicator { font-size: 0.9rem; color: var(--secondary-text); text-align: center; margin-bottom: 12px; font-weight: 400; letter-spacing: 0.05em; }
        .progress-bar { height: 4px; background: rgba(176, 196, 255, 0.1); border-radius: 4px; overflow: hidden; }
        .progress-fill { height: 100%; width: 0; background: linear-gradient(90deg, var(--accent-light) 0%, var(--accent-deep) 100%); border-radius: 4px; transition: width 1s ease-out; }
        .question-card { background: var(--blur-bg); backdrop-filter: blur(20px); border: 1px solid var(--border-color); border-radius: 16px; padding: 36px; margin-bottom: 24px; }
        .question-text { font-family: 'Noto Serif KR', serif; font-size: 1.35rem; line-height: 1.7; color: var(--primary-text); text-align: center; font-weight: 400; }
        .options { display: flex; flex-direction: column; gap: 14px; }
        .option-btn {
            background: var(--blur-bg);
            backdrop-filter: blur(15px);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            color: #cacedb;
            font-size: 1rem;
            line-height: 1.6;
        }
        .option-btn:hover { background: rgba(30, 41, 59, 0.7); border-color: rgba(176, 196, 255, 0.3); transform: translateX(5px); color: white; }

        /* --- 로딩 화면 --- */
        .loading-container { text-align: center; }
        .wave-loader { display: flex; justify-content: center; gap: 10px; margin-bottom: 32px; }
        .wave-dot { width: 10px; height: 10px; background: var(--accent-light); border-radius: 50%; animation: wave 1.5s infinite ease-in-out; }
        @keyframes wave { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }
        .wave-dot:nth-child(2) { animation-delay: 0.2s; }
        .wave-dot:nth-child(3) { animation-delay: 0.4s; }
        .loading-message { font-family: 'Noto Serif KR', serif; font-size: 1.1rem; color: var(--secondary-text); }

        /* --- 에필로그 (결과 화면) --- */
        .result-header { text-align: center; margin-bottom: 40px; }
        .result-badge { display: inline-block; padding: 8px 18px; background: rgba(176, 196, 255, 0.1); border: 1px solid rgba(176, 196, 255, 0.2); border-radius: 20px; font-size: 0.85rem; color: var(--accent-light); margin-bottom: 20px; font-weight: 500; letter-spacing: 0.1em; }
        .result-title { font-family: 'Noto Serif KR', serif; font-size: 2.1rem; font-weight: 500; line-height: 1.4; color: white; margin-bottom: 12px; }
        .result-subtitle { font-size: 1.05rem; color: var(--secondary-text); font-weight: 300; }
        .result-section { background: var(--blur-bg); backdrop-filter: blur(20px); border: 1px solid var(--border-color); border-radius: 16px; padding: 32px; margin-bottom: 20px; }
        .result-section h3 { font-family: 'Noto Serif KR', serif; font-size: 1.2rem; font-weight: 400; color: var(--primary-text); margin-bottom: 16px; }
        .result-section p { font-size: 1rem; line-height: 1.85; color: #d1d9e6; font-weight: 300; text-align: justify; word-break: keep-all; }
        .epilogue { background: linear-gradient(145deg, rgba(120, 140, 235, 0.05) 0%, rgba(176, 196, 255, 0.1) 100%); border-color: rgba(176, 196, 255, 0.2); }
        .epilogue-content { font-family: 'Noto Serif KR', serif; font-size: 1.05rem; text-align: center; }
        .epilogue-content strong { color: var(--accent-light); font-weight: 500; }
        .action-buttons { display: flex; gap: 12px; margin-top: 32px; }
        .btn-secondary { flex: 1; padding: 16px 24px; background: rgba(30, 41, 59, 0.6); border: 1px solid rgba(148, 163, 184, 0.2); border-radius: 12px; color: var(--primary-text); font-size: 0.95rem; font-weight: 500; cursor: pointer; transition: all 0.3s ease; letter-spacing: 0.05em; }
        .btn-secondary:hover { background: rgba(30, 41, 59, 0.8); border-color: rgba(148, 163, 184, 0.4); }
        .btn-text { display: block; margin: 24px auto 0; background: none; border: none; color: var(--secondary-text); font-size: 0.95rem; cursor: pointer; transition: color 0.3s; }
        .btn-text:hover { color: var(--primary-text); }
        .hidden { display: none !important; }
    </style>
</head>

<body>
    <audio id="bgm" loop>
        <source src="path/to/your/audio.mp3" type="audio/mpeg">
    </audio>

    <div class="container">
        <div class="screen" id="welcomeScreen">
            <h1 class="prologue-title">MIND DIVE</h1>
            <div class="intro-text">
                어떠한 소리도 닿지 않는 깊은 바다가 있습니다. 그곳에는 오직 침묵과, 아득한 어둠과, 제 자신을 밝히는 희미한 빛들만이 존재합니다.
                <br><br>
                당신의 마음 또한 그 심해와 같습니다. 일상의 파도가 잠잠해진 자리에, 누구에게도 들려주지 않은 당신만의 이야기가 고요히 잠들어 있습니다.
                <br><br>
                이제, 숨을 고르고 함께 내려가려 합니다. 두려워하지 마세요. 가장 깊은 곳에서 우리는, <strong>가장 빛나는 당신</strong>을 발견하게 될 테니까요.
            </div>
            <button class="btn-primary" id="startButton">탐사 시작</button>
        </div>
        
        <div class="screen hidden" id="divingScreen">
            <div class="diving-screen">
                 <p id="divingMessage"></p>
                 <span class="depth" id="divingDepth"></span>
            </div>
        </div>

        <div class="screen hidden" id="questionScreen">
            <div class="progress-section">
                <div class="depth-indicator" id="depthIndicator"></div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
            <div class="question-card">
                <p class="question-text" id="questionText"></p>
            </div>
            <div class="options" id="optionsContainer"></div>
        </div>

        <div class="screen hidden" id="loadingScreen">
            <div class="loading-container">
                <div class="wave-loader">
                    <div class="wave-dot"></div>
                    <div class="wave-dot"></div>
                    <div class="wave-dot"></div>
                </div>
                <p class="loading-message">심연의 신호를 분석하는 중...</p>
            </div>
        </div>

        <div class="screen hidden" id="resultScreen">
            <div class="result-header">
                <div class="result-badge">DISCOVERY LOG</div>
                <h2 class="result-title" id="resultTitle"></h2>
                <p class="result-subtitle" id="resultSubtitle"></p>
            </div>

            <div class="result-section">
                <h3>당신의 모습</h3>
                <p id="resultEssence"></p>
            </div>

            <div class="result-section">
                <h3>당신을 위한 기록</h3>
                <p id="resultAdvice"></p>
            </div>

            <div class="result-section epilogue">
                <p class="epilogue-content" id="resultComfort"></p>
            </div>

            <div class="action-buttons">
                <button class="btn-secondary" onclick="shareResult()">탐사 결과 공유</button>
                <button class="btn-secondary" onclick="copyLink()">링크 복사</button>
            </div>
            <button class="btn-text" onclick="restartDive()">다시 잠수하기</button>
        </div>
    </div>

    <script>
    // 페이지의 모든 HTML 요소가 로드된 후 스크립트를 실행합니다. (버튼 클릭 오류 방지)
    document.addEventListener('DOMContentLoaded', function() {

        // --- DOM Elements ---
        const welcomeScreen = document.getElementById('welcomeScreen');
        const divingScreen = document.getElementById('divingScreen');
        const questionScreen = document.getElementById('questionScreen');
        const loadingScreen = document.getElementById('loadingScreen');
        const resultScreen = document.getElementById('resultScreen');
        const startButton = document.getElementById('startButton');
        const bgm = document.getElementById('bgm');
        
        const divingMessage = document.getElementById('divingMessage');
        const divingDepth = document.getElementById('divingDepth');
        const depthIndicator = document.getElementById('depthIndicator');
        const progressFill = document.getElementById('progressFill');
        const questionText = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        
        const resultTitle = document.getElementById('resultTitle');
        const resultSubtitle = document.getElementById('resultSubtitle');
        const resultEssence = document.getElementById('resultEssence');
        const resultAdvice = document.getElementById('resultAdvice');
        const resultComfort = document.getElementById('resultComfort');

        // --- State ---
        let currentQuestionIndex = 0;
        let scores = { internal: 0, external: 0, stable: 0, fluid: 0 };

        // --- Data ---
        const questions = [
            { depth: "10m", zone: "빛이 스미는 표층", text: "고요한 바다에 처음 발을 담급니다.\n수면에 비친 당신의 모습에서 가장 먼저 눈에 들어오는 것은 무엇인가요?", options: [{ t: "잔잔하게 일렁이는 윤슬", s: { external: 1, fluid: 1 } }, { t: "알 수 없는 깊이의 푸른색", s: { internal: 1, stable: 1 } }, { t: "하늘과 구름의 경계 없는 비침", s: { external: 1, stable: 1 } }, { t: "내 안으로 가라앉는 나의 시선", s: { internal: 1, fluid: 1 } }] },
            { depth: "50m", zone: "빛이 스미는 표층", text: "주변으로 작은 물고기 떼가 모여듭니다.\n당신은 어떤 행동을 보이나요?", options: [{ t: "손을 뻗어 함께 유영하려 한다", s: { external: 1, fluid: 1 } }, { t: "그들의 움직임을 가만히 관찰한다", s: { internal: 1, stable: 1 } }, { t: "내가 갈 길을 향해 묵묵히 나아간다", s: { internal: 1, fluid: 1 } }, { t: "더 많은 생물이 있을 곳을 찾아 움직인다", s: { external: 1, stable: 1 } }] },
            { depth: "200m", zone: "희미한 빛의 미광층", text: "익숙했던 햇빛이 아득해지고, 위인지 아래인지 감각이 흐릿해집니다. 이때 당신의 마음은?", options: [{ t: "불안하기보다, 오히려 아늑하다", s: { internal: 1, stable: 1 } }, { t: "새로운 풍경에 대한 기대로 가득 찬다", s: { external: 1, fluid: 1 } }, { t: "나아갈 방향을 다시금 확인한다", s: { external: 1, stable: 1 } }, { t: "이 고요함의 의미를 조용히 사색한다", s: { internal: 1, fluid: 1 } }] },
            { depth: "500m", zone: "희미한 빛의 미광층", text: "저 멀리, 거대한 무언가의 그림자가 스쳐 지나갑니다. 당신의 첫 반응은?", options: [{ t: "정체를 확인하기 위해 가까이 다가간다", s: { external: 1, fluid: 1 } }, { t: "위험할 수 있으니, 조용히 숨어 지나가길 기다린다", s: { internal: 1, stable: 1 } }, { t: "나와는 다른 존재의 경이로움을 느낀다", s: { internal: 1, fluid: 1 } }, { t: "나의 탐사에 미칠 영향을 계산한다", s: { external: 1, stable: 1 } }] },
            { depth: "1,000m", zone: "어둠과 고요의 심해층", text: "완전한 어둠 속, 오직 당신의 숨소리만이 들려옵니다. 이 압도적인 고요함은 당신에게 무엇과 같나요?", options: [{ t: "모든 것으로부터의 자유", s: { internal: 1, fluid: 1 } }, { t: "스스로를 마주하게 하는 거울", s: { internal: 1, stable: 1 } }, { t: "새로운 발견을 앞둔 전조", s: { external: 1, fluid: 1 } }, { t: "포근하게 나를 감싸는 담요", s: { external: 1, stable: 1 } }] },
            { depth: "2,000m", zone: "어둠과 고요의 심해층", text: "어둠 속에서 스스로 빛을 내는 생명체를 마주칩니다. 그 빛을 보며 당신은 어떤 생각을 하나요?", options: [{ t: "어둠이 깊을수록 빛은 더 선명하구나", s: { internal: 1, stable: 1 } }, { t: "나 또한 나만의 빛을 가지고 있을까?", s: { internal: 1, fluid: 1 } }, { t: "저 빛은 다른 이들을 위한 등대일까?", s: { external: 1, stable: 1 } }, { t: "어떤 상황에서도 살아남는 생명력이 놀랍다", s: { external: 1, fluid: 1 } }] },
            { depth: "4,000m", zone: "미지의 심연", text: "마침내 심해의 바닥에 도착했습니다. 탐사를 계속할지, 아니면 이곳에 머물지 선택해야 합니다. 당신의 마음이 향하는 곳은?", options: [{ t: "이 평온함 속에 잠시 머물고 싶다", s: { internal: 1, stable: 1 } }, { t: "아직 발견하지 못한 무언가를 찾아 더 나아간다", s: { external: 1, fluid: 1 } }, { t: "이곳의 지도를 그려 다른 탐사자에게 알린다", s: { external: 1, stable: 1 } }, { t: "지금까지의 여정을 되짚어보며 의미를 찾는다", s: { internal: 1, fluid: 1 } }] },
            { depth: "6,000m", zone: "미지의 심연", text: "탐사의 끝에서, 당신은 무언가를 발견합니다. 그것은 당신에게 어떤 의미로 다가오나요?", options: [{ t: "오랜 시간 지켜온 변치 않는 가치", s: { stable: 2 } }, { t: "세상과 나를 연결하는 따뜻한 온기", s: { external: 2 } }, { t: "내 안에 숨겨져 있던 또 다른 나의 모습", s: { internal: 2 } }, { t: "자유롭게 흘러갈 새로운 시작점", s: { fluid: 2 } }] }
        ];

        const results = {
            'internal-stable': { title: "심해의 진주", sub: "고요히 빛을 머금은 영혼", essence: "당신은 외부의 소란에 쉽게 흔들리지 않는 깊은 내면의 힘을 지녔습니다. 혼자만의 시간을 통해 에너지를 얻고, 복잡한 세상 속에서 자신만의 중심을 지키려 노력하죠. 상처와 고독을 회피하기보다, 그것을 끌어안고 단단한 아름다움으로 만들어내는 성숙함을 가지고 있습니다.", advice: "당신의 깊이는 때로 스스로를 고립시킬 수 있습니다. 괜찮다면, 당신이 오랜 시간 품어온 그 영롱한 빛을 가끔은 세상에 보여주세요. 당신의 고요한 위로가 필요한 사람이 분명 있을 거예요.", comfort: "진주가 되기 위해 모래알이 겪었을 수많은 밤을 기억하세요.<br><strong>당신의 모든 상처와 인내는 결코 헛되지 않았습니다.</strong>" },
            'internal-fluid': { title: "미광 해파리", sub: "어둠 속을 유영하는 자유로운 영혼", essence: "당신은 정해진 길을 따르기보다, 내면의 흐름과 직관에 몸을 맡기는 자유로운 영혼입니다. 생각의 경계가 없고, 예술적인 감수성이 풍부하죠. 혼자만의 사색과 상상 속에서 누구보다 화려한 빛을 발하며, 당신의 존재 자체가 하나의 신비로운 예술 작품과 같습니다.", advice: "자유로운 당신의 흐름은 때로 현실의 뭍과 부딪히며 상처받을 수 있습니다. 당신의 연약한 빛을 지켜줄 단단한 무언가를 곁에 두는 것을 잊지 마세요. 그것이 사람이든, 신념이든, 혹은 작은 습관이든 좋습니다.", comfort: "세상의 속도에 맞출 필요 없어요.<br><strong>당신만의 박자로 유영할 때 가장 아름답게 빛나니까요.</strong>" },
            'external-stable': { title: "빛의 산호 군락", sub: "생명을 보듬어 세계를 일구는 영혼", essence: "당신은 자신만의 단단한 신념을 바탕으로 주변에 긍정적인 영향력을 미치는 사람입니다. 안정적인 관계를 소중히 여기며, 당신이 아끼는 사람들을 위한 든든한 안식처가 되어주고 싶어 하죠. 당신의 노력은 황량한 바닥을 다채로운 생명이 넘실대는 산호 군락으로 바꾸는 힘이 있습니다.", advice: "모든 것을 지키려는 책임감에 스스로 지치지 않도록 조심하세요. 때로는 조류에 몸을 맡기듯, 주변의 도움을 청하고 함께 나아가는 법을 배워보세요. 당신은 혼자가 아닙니다.", comfort: "당신이 오랜 시간 공들여 만든 그 아름다운 세계를 보세요.<br><strong>당신의 존재만으로도 수많은 생명이 위로받고 있습니다.</strong>" },
            'external-fluid': { title: "심해의 해류", sub: "온기를 전하며 길을 만들어내는 영혼", essence: "당신은 한곳에 머무르기보다, 세상과 끊임없이 소통하며 에너지를 얻는 사람입니다. 새로운 만남과 경험을 두려워하지 않으며, 당신의 유연함과 따뜻함은 차가운 심해에 온기를 불어넣는 해류와 같습니다. 당신이 흐르는 곳마다 새로운 생명과 가능성이 싹틉니다.", advice: "끊임없이 흐르다 보면, 정작 당신의 마음이 어디로 향하고 있는지 잊을 때가 있습니다. 가끔은 잠시 멈춰, 당신의 내면의 소리에 귀 기울여 주세요. 당신이 진정으로 원하는 것은 무엇인가요?", comfort: "정체되지 않고 끊임없이 흐르는 것이야말로 살아있다는 증거입니다.<br><strong>당신은 세상의 막힌 곳을 뚫고, 차가운 곳을 데우는 소중한 존재입니다.</strong>" },
            'internal-stable-alt': { title: "침몰선의 닻", sub: "시간의 무게를 견디며 가치를 지키는 영혼", essence: "당신은 시간의 흐름 속에서도 변치 않는 자신만의 가치와 신념을 굳건히 지키는 사람입니다. 역경은 당신을 더 단단하게 만들며, 그 깊이와 무게감은 주변 사람들에게 신뢰와 안정감을 줍니다. 당신의 존재는 격랑 속에서도 배를 지탱하는 묵직한 닻과 같습니다.", advice: "때로는 그 묵직함이 스스로를 얽매는 족쇄가 될 수 있습니다. 과거의 영광이나 상처에 너무 얽매이지 말고, 새로운 항해를 위해 닻을 올릴 용기를 내보는 건 어떨까요?", comfort: "모든 풍파를 견뎌낸 당신의 단단함을 존경합니다.<br><strong>당신이 지켜온 시간과 가치는 그 무엇과도 바꿀 수 없는 보물입니다.</strong>" },
            'internal-fluid-alt': { title: "고래의 노래", sub: "심연에 진실을 노래하는 깊은 영혼", essence: "당신은 세상의 표면적인 소음 너머, 더 깊은 곳의 진실과 교감하는 영혼입니다. 당신의 생각과 감정은 너무나 깊고 거대하여 때로 다른 이들이 쉽게 이해하지 못할 수 있습니다. 그 깊이에서 울려 나오는 당신의 목소리는 심연 전체를 울리는 고래의 노래와 같습니다.", advice: "당신의 노래가 너무 외롭게 느껴질 때, 기억하세요. 주파수가 맞는 누군가는 반드시 당신의 소리를 듣고 있습니다. 그 울림을 포기하지 마세요.", comfort: "당신의 깊이를 세상이 이해하지 못한다고 슬퍼하지 마세요.<br><strong>가장 심오한 노래는 언제나 가장 깊은 곳에서 시작됩니다.</strong>" },
            'external-stable-alt': { title: "해저 화산의 흑요석", sub: "차가운 열정을 품은 창조의 영혼", essence: "평소 당신은 냉철하고 이성적으로 보이지만, 그 안에는 세상을 바꿀 만큼 뜨거운 열정과 창조의 에너지를 품고 있습니다. 당신의 결단과 추진력은 심해의 압력을 뚫고 새로운 섬을 만들어내는 해저 화산처럼 강력합니다. 당신이 벼려낸 결과물은 흑요석처럼 날카롭고 아름답습니다.", advice: "뜨거운 열정이 분출될 때, 주변의 모든 것을 태워버릴 수 있음을 경계하세요. 당신의 힘을 다룰 수 있는 섬세함과 지혜를 함께 기를 필요가 있습니다.", comfort: "차가운 심해 속에서도 뜨거운 심장을 잃지 않은 당신.<br><strong>당신의 열정은 세상을 창조하는 위대한 힘입니다.</strong>" },
            'external-fluid-alt': { title: "별빛 플랑크톤", sub: "함께 기적을 수놓는 연결의 영혼", essence: "당신은 스스로를 드러내기보다, 다른 이들과 함께 어우러져 아름다운 풍경을 만들어내는 사람입니다. 개개의 움직임은 작아 보일지 몰라도, 그 연결이 모여 밤바다를 수놓는 별빛처럼 거대한 기적과 감동을 만들어냅니다. 당신의 친화력과 공감 능력은 세상을 엮는 보이지 않는 끈입니다.", advice: "다른 이들과의 조화에 너무 집중한 나머지, 당신 자신의 빛을 잃지 않도록 주의하세요. 당신이라는 별 하나가 사라지면, 이 밤하늘은 결코 같을 수 없습니다.", comfort: "혼자서는 낼 수 없는 빛을 함께 만들어내는 당신의 존재를 응원합니다.<br><strong>당신의 작은 몸짓 하나하나가 세상을 더 아름답게 만들고 있습니다.</strong>" }
        };

        // --- Functions ---
        function switchScreen(hide, show) {
            hide.classList.add('hidden');
            show.classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function showDivingTransition(callback) {
            const question = questions[currentQuestionIndex];
            divingMessage.textContent = `${question.zone}으로...`;
            divingDepth.textContent = `수심 ${question.depth}`;
            switchScreen(questionScreen, divingScreen);
            setTimeout(() => {
                switchScreen(divingScreen, questionScreen);
                callback();
            }, 1800);
        }

        function showQuestion() {
            const question = questions[currentQuestionIndex];
            progressFill.style.width = `${((currentQuestionIndex + 1) / questions.length) * 100}%`;
            depthIndicator.textContent = `수심 ${question.depth} | ${question.zone}`;
            questionText.innerHTML = question.text.replace(/\n/g, '<br>');
            optionsContainer.innerHTML = '';
            question.options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-btn';
                button.innerHTML = option.t;
                button.onclick = () => handleAnswer(option.s);
                optionsContainer.appendChild(button);
            });
        }

        function handleAnswer(score) {
            for (const key in score) { scores[key] += score[key]; }
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                if ([2, 4, 6].includes(currentQuestionIndex)) {
                    showDivingTransition(showQuestion);
                } else {
                    showQuestion();
                }
            } else {
                showLoadingAndResult();
            }
        }
        
        function showLoadingAndResult() {
            switchScreen(questionScreen, loadingScreen);
            setTimeout(calculateAndShowResult, 3000);
        }

        function calculateAndShowResult() {
            const primaryAxis = scores.internal >= scores.external ? 'internal' : 'external';
            const secondaryAxis = scores.stable >= scores.fluid ? 'stable' : 'fluid';
            let resultKey = `${primaryAxis}-${secondaryAxis}`;
            if (scores[primaryAxis] > scores[primaryAxis === 'internal' ? 'external' : 'internal'] * 1.5 ||
                scores[secondaryAxis] > scores[secondaryAxis === 'stable' ? 'fluid' : 'stable'] * 1.5) {
                 resultKey += '-alt';
            }
            const resultData = results[resultKey] || results[`${primaryAxis}-${secondaryAxis}`];
            resultTitle.innerHTML = resultData.title;
            resultSubtitle.innerHTML = resultData.sub;
            resultEssence.innerHTML = resultData.essence;
            resultAdvice.innerHTML = resultData.advice;
            resultComfort.innerHTML = resultData.comfort;
            switchScreen(loadingScreen, resultScreen);
        }
        
        function startDive() {
            bgm.play().catch(e => console.log("BGM 자동 재생이 차단되었습니다. 사용자 상호작용이 필요합니다."));
            currentQuestionIndex = 0;
            scores = { internal: 0, external: 0, stable: 0, fluid: 0 };
            switchScreen(welcomeScreen, questionScreen);
            showQuestion();
        }

        function restartDive() {
            switchScreen(resultScreen, welcomeScreen);
        }

        // --- Global Functions for onclick ---
        window.shareResult = async function() {
            try {
                await navigator.share({ title: 'MIND DIVE - 나의 탐사 결과', text: `나의 마음 속 심해에서 '${resultTitle.textContent}'을(를) 발견했어요.`, url: window.location.href });
            } catch (err) { alert("공유하기를 지원하지 않는 환경입니다."); }
        }
        window.copyLink = function() {
            navigator.clipboard.writeText(window.location.href).then(() => alert('탐사 기록 링크가 복사되었습니다!'));
        }
        window.restartDive = restartDive;

        // --- Event Listeners ---
        startButton.addEventListener('click', startDive);
    });
    </script>
</body>
</html>
